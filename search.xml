<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>6.824-lab1</title>
      <link href="/6-824-lab1/"/>
      <url>/6-824-lab1/</url>
      
        <content type="html"><![CDATA[<p>å®éªŒ1 æ˜¯å®ç°ä¸€ä¸ª mapreduce æ¡†æ¶ï¼Œæœ‰å‡ ä¸ªéš¾ç‚¹ï¼š</p><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¹¶å‘é—®é¢˜</p><p>å®ç°å®¹ç¾ï¼ˆæœ¬å®éªŒè§„å®š 10s æœªå“åº”å³ä¸º crashï¼‰</p><p>å…¶ä¸­çš„å¹¶å‘é—®é¢˜ï¼Œå‡ ä¹å…¨éƒ¨ç”± go çš„ channel æ¥è§£å†³ï¼Œåˆ¤æ–­ä»»åŠ¡å®Œæˆä½¿ç”¨ atomic.Boolï¼Œä»»åŠ¡åˆ†å‘ç”¨äº†ä¸€ä¸ª channel æ¥æ¨¡æ‹Ÿç®€æ˜“çš„ä»»åŠ¡é˜Ÿåˆ—</p><p>ä½¿ç”¨åˆ°çš„ç»“æ„ä½“</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">type</span> Task <span class="token keyword">struct</span> <span class="token punctuation">{</span>Num      <span class="token builtin">int</span>TaskID   <span class="token builtin">int</span>JobType  <span class="token builtin">int</span>Filename <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token keyword">type</span> Coordinator <span class="token keyword">struct</span> <span class="token punctuation">{</span>MapNum    <span class="token builtin">int</span>ReduceNum <span class="token builtin">int</span>Finish    <span class="token keyword">chan</span> <span class="token builtin">bool</span>Taskq     <span class="token keyword">chan</span> <span class="token operator">*</span>TaskTimeq     <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">chan</span> <span class="token builtin">bool</span>Flag      atomic<span class="token punctuation">.</span>Bool<span class="token punctuation">}</span><span class="token keyword">type</span> Request <span class="token keyword">struct</span> <span class="token punctuation">{</span>Questype <span class="token builtin">int</span>TaskID   <span class="token builtin">int</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>worker å®ç°æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è½®è¯¢å°±è¡Œ</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Worker</span><span class="token punctuation">(</span>mapf <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>KeyValue<span class="token punctuation">,</span>reducef <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>r <span class="token operator">:=</span> Request<span class="token punctuation">{</span>Questype<span class="token punctuation">:</span> NoJob<span class="token punctuation">}</span><span class="token keyword">for</span> <span class="token punctuation">{</span>t <span class="token operator">:=</span> Task<span class="token punctuation">{</span><span class="token punctuation">}</span>ok <span class="token operator">:=</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"Coordinator.GetTask"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"call failed!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">switch</span> t<span class="token punctuation">.</span>JobType <span class="token punctuation">{</span><span class="token keyword">case</span> Map<span class="token punctuation">:</span><span class="token function">doMap</span><span class="token punctuation">(</span>mapf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span>r<span class="token punctuation">.</span>Questype <span class="token operator">=</span> Finishr<span class="token punctuation">.</span>TaskID <span class="token operator">=</span> t<span class="token punctuation">.</span>TaskID<span class="token keyword">case</span> Reduce<span class="token punctuation">:</span><span class="token function">doReduce</span><span class="token punctuation">(</span>reducef<span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span>r<span class="token punctuation">.</span>Questype <span class="token operator">=</span> Finishr<span class="token punctuation">.</span>TaskID <span class="token operator">=</span> t<span class="token punctuation">.</span>TaskID<span class="token keyword">case</span> Wait<span class="token punctuation">:</span>time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>r<span class="token punctuation">.</span>Questype <span class="token operator">=</span> NoJob<span class="token keyword">case</span> Complete<span class="token punctuation">:</span><span class="token keyword">return</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>crash å¤„ç†ç”¨äº† select ä¸ time.After è§£å†³</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Coordinator<span class="token punctuation">)</span> <span class="token function">wait</span><span class="token punctuation">(</span>t <span class="token operator">*</span>Task<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">select</span> <span class="token punctuation">{</span><span class="token keyword">case</span> <span class="token operator">&lt;-</span>c<span class="token punctuation">.</span>Timeq<span class="token punctuation">[</span>t<span class="token punctuation">.</span>TaskID<span class="token punctuation">]</span><span class="token punctuation">:</span>c<span class="token punctuation">.</span>Finish <span class="token operator">&lt;-</span> <span class="token boolean">true</span><span class="token keyword">case</span> <span class="token operator">&lt;-</span>time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>c<span class="token punctuation">.</span>Taskq <span class="token operator">&lt;-</span> t<span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ›æ‰£è¶£é¢˜é›†</title>
      <link href="/li-kou-qu-ti-ji/"/>
      <url>/li-kou-qu-ti-ji/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡é•¿æœŸæ›´æ–°ï¼Œè®°å½•åŠ›æ‰£ç¢°åˆ°çš„ä¸€äº›è¶£é¢˜<br><a href="https://leetcode.cn/u/cutecaidd/">æˆ‘çš„åŠ›æ‰£ä¸»é¡µ</a></p><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><h3 id="å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†çš„æœ€ä½å¾—åˆ†"><a href="#å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†çš„æœ€ä½å¾—åˆ†" class="headerlink" title="å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†çš„æœ€ä½å¾—åˆ†"></a><a href="https://leetcode.cn/problems/minimum-score-triangulation-of-polygon/">å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†çš„æœ€ä½å¾—åˆ†</a></h3><h4 id="é¢˜ç›®å¤§æ„"><a href="#é¢˜ç›®å¤§æ„" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h4><p>ç»™ä½ ä¸€ä¸ªå‡¸ $n$ è¾¹å½¢ï¼Œè¦ä½ æŠŠå®ƒå…¨éƒ¨åˆ†æˆä¸‰è§’å½¢ï¼Œæ¯ä¸ªä¸‰è§’å½¢çš„å¾—åˆ†ä¸ºä¸‰ä¸ªé¡¶ç‚¹æ•°å­—çš„ä¹˜ç§¯ï¼Œæ±‚è¯¥å›¾å½¢æœ€ä½æ€»å¾—åˆ†</p><p>ä¾‹å­ï¼šä¸‹å›¾çš„æœ€ä½æ€»å¾—åˆ†å³ä¸º13</p><p><img src="https://assets.leetcode.com/uploads/2021/02/25/shape3.jpg"></p><h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>è¿™é¢˜è™½ç„¶ä¸éš¾ï¼Œä½†æ˜¯è½¬æ¢è¿˜æ˜¯æŒºå·§å¦™çš„ï¼Œå°†å›¾å½¢çš„ä¸€æ¡è¾¹å½“ä½œåŒºé—´DPä¸­çš„åŒºé—´ï¼Œè¾¹å·¦å³ä¾§çš„å›¾å½¢åˆå½¢æˆæ–°çš„å›¾å½¢ç»§ç»­åˆ†å‰²ã€‚é€‰å–åˆ†å‰²ç‚¹ï¼Œå°±æ˜¯ç»™ä¸€æ¡è¾¹å·²æœ‰çš„ä¸¤ä¸ªç‚¹é€‰å‰©ä¸‹çš„ä¸€ä¸ªç‚¹ç»„æˆä¸‰è§’å½¢ï¼Œå†åŠ ä¸Šå·¦å³å›¾å½¢çš„å¾—åˆ†å°±æ˜¯é€‰å–å½“å‰åˆ†å‰²ç‚¹çš„æ€»å¾—åˆ†ï¼Œé‚£ä¹ˆDPä½¿å…¶æœ€å°å³å¯ã€‚è¿™é‡Œé€‰ç”¨è®°å¿†åŒ–æœç´¢å½¢å¼æ¥å†™ï¼Œä»£ç æ›´åŠ ç®€å•ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">minScoreTriangulation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> v<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>        <span class="token decorator annotation punctuation">@cache</span>        <span class="token keyword">def</span> <span class="token function">dfs</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> l <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">==</span> r<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token number">0</span>            <span class="token keyword">return</span> <span class="token builtin">min</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">*</span> v<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">*</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> dfs<span class="token punctuation">(</span>l<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> dfs<span class="token punctuation">(</span>i<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> dfs<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><h3 id="å­æ•°ç»„ä¸­å ç»å¤§å¤šæ•°çš„å…ƒç´ "><a href="#å­æ•°ç»„ä¸­å ç»å¤§å¤šæ•°çš„å…ƒç´ " class="headerlink" title="å­æ•°ç»„ä¸­å ç»å¤§å¤šæ•°çš„å…ƒç´ "></a><a href="https://leetcode.cn/problems/online-majority-element-in-subarray/">å­æ•°ç»„ä¸­å ç»å¤§å¤šæ•°çš„å…ƒç´ </a></h3><h4 id="é¢˜ç›®å¤§æ„-1"><a href="#é¢˜ç›®å¤§æ„-1" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h4><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡æŸ¥è¯¢æ•°ç»„æŸä¸ªåŒºé—´å‡ºç° <code>threshold</code> æ¬¡æ•°æˆ–æ¬¡æ•°ä»¥ä¸Šçš„å…ƒç´ ï¼Œä¿è¯ <code>threshold</code> å¤§äºåŒºé—´é•¿åº¦çš„ä¸€åŠã€‚</p><p>åŒºé—´é•¿åº¦ä¸æŸ¥è¯¢æ¬¡æ•°éƒ½æ˜¯ $10^4$ çš„é‡çº§</p><h4 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>ç”¨æ•°æ®ç»“æ„çš„è¯ï¼Œç›´æ¥æƒå€¼çº¿æ®µæ ‘ç»´æŠ¤ + æ‘©å°”æŠ•ç¥¨å°±å¥½äº†ã€‚ä½†è¿™ä¹ˆæ— è¶£çš„åšæ³•ï¼Œè‚¯å®šä¸Šä¸äº†è¿™ç¯‡åšå®¢ã€‚</p><p>åè¿‡æ¥æ€è€ƒï¼Œå¦‚æœè¯¥åŒºé—´å­˜åœ¨ä¸€ä¸ªæ•°å‡ºç°æ¬¡æ•°å¤§äºç­‰äº <code>threshold</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¯¥åŒºé—´éšä¾¿é€‰ä¸€ä¸ªæ•°ï¼Œæ˜¯ç›®æ ‡æ•°çš„æ¦‚ç‡å¤§äº 50%ï¼Œè¿™æ˜¯å¤šä¹ˆé«˜çš„æ¦‚ç‡ï¼</p><p>å› æ­¤å¯ä»¥ç›´æ¥éšæœºåŒ–é€‰æ•°ä¸€å®šæ¬¡æ•°ï¼Œæ¯æ¬¡é€šè¿‡äºŒåˆ†åˆ¤æ–­è¯¥æ•°åœ¨å½“å‰åŒºé—´å‡ºç°æ¬¡æ•°æ˜¯å¦å¤§äº <code>threshold</code> ã€‚å¦‚æœæ»¡è¶³ç›´æ¥è¿”å›ã€‚å¦‚æœéšæœºåŒ–é€‰å–ç»“æŸåè¿˜æ²¡æœ‰ï¼Œå°±å‡å®šä¸å­˜åœ¨è¿™æ ·çš„æ•°ã€‚</p><p>å‚è€ƒ<a href="https://leetcode.cn/problems/online-majority-element-in-subarray/solution/suiji-by-981377660lmt-fw82/">ğŸ“å¤§ä½¬</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MajorityChecker</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> arr<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> arr        self<span class="token punctuation">.</span>indexes <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>          <span class="token keyword">for</span> i<span class="token punctuation">,</span> num <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> left<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> threshold<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>        ROUND <span class="token operator">=</span> <span class="token number">20</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>ROUND<span class="token punctuation">)</span><span class="token punctuation">:</span>            index <span class="token operator">=</span> randint<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">)</span>            num <span class="token operator">=</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span>            count <span class="token operator">=</span> bisect_right<span class="token punctuation">(</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">-</span> bisect_left<span class="token punctuation">(</span>self<span class="token punctuation">.</span>indexes<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">)</span>            <span class="token keyword">if</span> count <span class="token operator">&gt;=</span> threshold<span class="token punctuation">:</span> <span class="token keyword">return</span> num        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¨‹åºè®¾è®¡ç«èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•é¢˜ </tag>
            
            <tag> åŠ›æ‰£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>inet_ntoaä¸çº¿ç¨‹å®‰å…¨</title>
      <link href="/inet-ntoa-yu-xian-cheng-an-quan/"/>
      <url>/inet-ntoa-yu-xian-cheng-an-quan/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰åœ¨ã€ŠLinuxé«˜æ€§èƒ½æœåŠ¡å™¨ç¼–ç¨‹ã€‹ä¸­å°±æœ‰å­¦ä¹ åˆ° inet_ntoa å‡½æ•°ä¸å¯é‡å…¥ã€‚</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230401151114.png"></p><p>å¹¶ä¸”ç”¨ç¨‹åºéªŒè¯äº†ä¸‹</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstdio&gt;</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">struct</span> <span class="token class-name">in_addr</span> addr1<span class="token punctuation">,</span> addr2<span class="token punctuation">;</span>  addr1<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"192.180.2.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  addr2<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"211.179.3.2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">auto</span> s1 <span class="token operator">=</span> <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>addr1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">auto</span> s2 <span class="token operator">=</span> <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>addr2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%p %s\n"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%p %s\n"</span><span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>0x7f34cabfa510 211.179.3.2<br>0x7f34cabfa510 211.179.3.2</p><p>æ‰€ä»¥æ˜“éªŒè¯å…¶ä¸å¯é‡å…¥æ€§</p><p>ç„¶è€Œä»Šå¤© clang-tidy ç»™äº†æˆ‘ä¸€ä¸ª warning</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230401151942.png"></p><p>è¿™ä¼¼ä¹åˆæƒ…åˆç†ï¼Œå› ä¸ºå…¶å†…éƒ¨åªæœ‰ä¸€ä¸ªé™æ€ç¼“å†²åŒºï¼Œå¤šä¸ªçº¿ç¨‹å¯èƒ½ä¼šé‡å¤è¦†ç›–ï¼Œä½†çœŸçš„å¦‚æ­¤å—ï¼Ÿ</p><p>ï¼ˆæ³¨ï¼šposix æ ‡å‡†è§„å®š stdio å‡½æ•°å‡ä¸ºåŸå­çš„ï¼Œæ•… printf ä¸ç”¨åŒæ­¥ï¼Œä¸ä¼šåƒ cout ä¸€æ ·æ··ä¹±ï¼‰</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">struct</span> <span class="token class-name">in_addr</span> addr<span class="token punctuation">;</span>  addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">auto</span> s <span class="token operator">=</span> <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%p %s\n"</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">work1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"192.180.2.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">work2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"211.179.3.2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>thread <span class="token function">x1</span><span class="token punctuation">(</span>work1<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token double-colon punctuation">::</span>thread <span class="token function">x2</span><span class="token punctuation">(</span>work2<span class="token punctuation">)</span><span class="token punctuation">;</span>  x1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  x2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>0x7f7aaf10d6b0 192.180.2.1<br>0x7f7aae90c6b0 211.179.3.2</p><p>å‘ç°ï¼Œè²Œä¼¼ inet_ntoa æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p><p>å°æ‰’ gnu c library æºç çœ‹ä¸€çœ‹</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230401161255.png"></p><p>äºæ˜¯å‘ç°äº†ä¸ª __thread å…³é”®å­—ã€‚</p><p>__threadæ˜¯GCCå†…ç½®çš„çº¿ç¨‹å±€éƒ¨å­˜å‚¨è®¾æ–½ã€‚__thread å˜é‡æ¯ä¸€ä¸ªçº¿ç¨‹æœ‰ä¸€ä»½ç‹¬ç«‹å®ä½“ï¼Œå„ä¸ªçº¿ç¨‹çš„å€¼äº’ä¸å¹²æ‰°ã€‚å¯ä»¥ç”¨æ¥ä¿®é¥°é‚£äº›å¸¦æœ‰å…¨å±€æ€§ä¸”å€¼å¯èƒ½å˜ï¼Œä½†æ˜¯åˆä¸å€¼å¾—ç”¨å…¨å±€å˜é‡ä¿æŠ¤çš„å˜é‡ã€‚</p><p>çœ‹æ¥å’Œ C++11 çš„ thread_local å·®ä¸å¤š</p><p>æ‰€ä»¥å¯ä»¥æš‚ä¸”è®¤ä¸ºå…¶æ˜¯çº¿ç¨‹å®‰å…¨çš„</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ç½‘ç»œç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++æ™ºèƒ½æŒ‡é’ˆ</title>
      <link href="/c-zhi-neng-zhi-zhen/"/>
      <url>/c-zhi-neng-zhi-zhen/</url>
      
        <content type="html"><![CDATA[<p>å‰å‡ å¤©ç±³å“ˆæ¸¸ä¸€é¢ï¼Œé¢è¯•å®˜å¾ˆå¸…ï¼Œå¾ˆæ¸©æŸ”ï¼Œé—®çš„ä¹Ÿå¾ˆåŸºç¡€ï¼Œä¸è¿‡æœ‰äº›ä¼šç»“åˆåœºæ™¯è¿›è¡Œè¿½é—®ã€‚ç”±äºæ˜¯ç¬¬ä¸€æ¬¡é¢è¯•ï¼Œæ•´ä¸ªäººéƒ½æŒºç´§å¼ ï¼Œæ„Ÿè§‰åŸºç¡€ç¡®å®è¿˜æ˜¯ä¸æ‰å®ï¼Œæœ‰äº›å¾ˆåŸºç¡€ä½†æ²¡æ€ä¹ˆç”¨åˆ°è¿‡çš„ä¸œè¥¿å°±æ²¡å¤ªå…³æ³¨ã€‚è¿™ç¯‡æ–‡ç« æ€»ç»“ä¸‹é¢è¯•é‡åˆ°çš„C++æ™ºèƒ½æŒ‡é’ˆé—®é¢˜ã€‚</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æ™ºèƒ½æŒ‡é’ˆä¸»è¦æœ‰ <code>unique_ptr</code>ï¼Œ<code>shared_ptr</code>ï¼Œ<code>weak_ptr</code>ã€‚<code>auto_ptr</code> æ˜¯åœ¨ C++ 11 ä¹‹å‰ä½œä¸ºæ™ºèƒ½æŒ‡é’ˆå®éªŒå“å‘æ˜å‡ºæ¥ï¼Œä½†ç”±äºå…¶è¿åäººç›´è§‰çš„ç‰¹æ€§ï¼ˆåé¢ä¼šè¡¥å……æåˆ°ï¼‰ï¼Œåœ¨C++11æå‡ºå³å€¼å¼•ç”¨ä¸ç§»åŠ¨è¯­ä¹‰åï¼Œå…¶å·²è¢«å¼ƒç”¨ã€‚</p><p>ä¸ªäººè®¤ä¸ºæ™ºèƒ½æŒ‡é’ˆæ˜¯å¯¹C++ RAIIï¼ˆ<strong>R</strong>esource <strong>A</strong>cquisition <strong>I</strong>s <strong>I</strong>nitializationï¼Œèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰çš„ä¸€ç§æä½³å®è·µã€‚RAIIè¦æ±‚ï¼Œèµ„æºçš„æœ‰æ•ˆæœŸä¸æŒæœ‰èµ„æºçš„å¯¹è±¡çš„ç”Ÿå‘½æœŸä¸¥æ ¼ç»‘å®šï¼Œå³ç”±å¯¹è±¡çš„æ„é€ å‡½æ•°å®Œæˆèµ„æºçš„åˆ†é…ï¼ˆè·å–ï¼‰ï¼ŒåŒæ—¶ç”±ææ„å‡½æ•°å®Œæˆèµ„æºçš„é‡Šæ”¾ã€‚åœ¨è¿™ç§è¦æ±‚ä¸‹ï¼Œåªè¦å¯¹è±¡èƒ½æ­£ç¡®åœ°ææ„ï¼Œå°±ä¸ä¼šå‡ºç°èµ„æºæ³„éœ²é—®é¢˜ã€‚</p><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><h3 id="unique-ptr"><a href="#unique-ptr" class="headerlink" title="unique_ptr"></a>unique_ptr</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// // std::unique_ptr&lt;A&gt; a(new A); è¿™ç§å†™æ³•ä¸æ¨èï¼Œåç»­ä¼šè®²åˆ°</span>  <span class="token keyword">auto</span> a <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>A<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  a<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>create class A<br>class A<br>delete class A</p><p>å¯è§é™¤äº†å¯ä»¥è‡ªåŠ¨ç®¡ç†èµ„æºä»¥å¤–ï¼Œå°±å’Œä¸€ä¸ªæ™®é€šçš„æŒ‡é’ˆçš„ç”¨æ³•å·®ä¸å¤šã€‚ä¸è¿‡ï¼Œå¦‚åŒuniqueçš„å«ä¹‰ä¸€æ ·ï¼Œunique_ptræ˜¾å¼åˆ é™¤äº†æ‹·è´æ„é€ å‡½æ•°ä¸èµ‹å€¼è¿ç®—ç¬¦ï¼Œä»¥ä¿è¯èµ„æºè¢«ç‹¬ç«‹ç®¡ç†ã€‚å¦‚æœæƒ³è¦å°†ä¸€ä¸ªuniqueçš„èµ„æºç»™å¦ä¸€ä¸ªï¼Œåˆ™åªèƒ½ä½¿ç”¨<strong>ç§»åŠ¨è¯­ä¹‰</strong>æ¥<strong>è½¬ç§»</strong>èµ„æºã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>A<span class="token operator">&gt;</span> b <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç„¶ï¼Œæ™ºèƒ½æŒ‡é’ˆé‡Œé¢æœ‰ä¸€äº›é€šç”¨çš„å‡½æ•°ï¼Œä½†æ˜¯ä¸ªäººæ„Ÿè§‰é‚£äº›å‡½æ•°å…¶å®éƒ½æœ‰æ‰“ç ´æŒ‡é’ˆç®¡ç†çš„å€¾å‘ï¼Œåº”å½“å°‘ç”¨ï¼Œåˆå§‹åŒ–å®Œåå½“æˆæ™®é€šæŒ‡é’ˆç”¨æ˜¯æœ€å¥½çš„ã€‚</p><h3 id="shared-ptr"><a href="#shared-ptr" class="headerlink" title="shared_ptr"></a>shared_ptr</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">auto</span> a <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>A<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">auto</span> <span class="token function">b</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>create class A<br>delete class A</p><p>å¯è§shared_ptrå°±æ˜¯åœ¨å†…éƒ¨åªä¿ç•™äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå½“æŒ‡å‘ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰shared_ptrå…¨éƒ¨ææ„ï¼Œå¯¹è±¡èµ„æºæ‰ä¼šè¢«é‡Šæ”¾ã€‚å…¶å†…éƒ¨æ˜¯ä½¿ç”¨å¼•ç”¨è®¡æ•°å®ç°çš„ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œshared_ptrçš„å¼•ç”¨è®¡æ•°æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç”¨äº†åŸå­ç±»å‹ã€‚</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230318213018.png"></p><p>å¯è§å½“ <code>_Sp_counted_base</code> æ¨¡æ¿ç±»å‹ä¸º <code>_S_atomic</code>  æ—¶ï¼Œå¼•ç”¨è®¡æ•°çš„å¢åŠ ä½¿ç”¨CASï¼ˆcompare and swapï¼‰åŸè¯­ï¼ˆä¸€èˆ¬æ˜¯æŒ‡<strong>ç”±è‹¥å¹²æ¡æŒ‡ä»¤ç»„æˆçš„ç¨‹åºæ®µï¼Œç”¨æ¥å®ç°æŸä¸ªç‰¹å®šåŠŸèƒ½ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸å¯è¢«ä¸­æ–­</strong>ï¼‰ã€‚CASå¤§è‡´æ˜¯è¿™æ ·æ“ä½œçš„ï¼Œå°†é¢„æœŸå€¼å’Œå†…å­˜åœ°å€çš„å®é™…å€¼æ¯”è¾ƒï¼Œè‹¥ä¸ç›¸ç­‰ï¼Œåˆ™ç”¨å†…å­˜åœ°å€çš„å®é™…å€¼æ›¿æ¢é¢„æœŸå€¼ï¼Œå¹¶æ ¹æ®é¢„æœŸå€¼é‡æ–°è®¡ç®—ä¿®æ”¹å€¼ã€‚å½“å‘ç°é¢„æœŸå€¼å’Œå†…å­˜åœ°å€çš„å®é™…å€¼ç›¸ç­‰åï¼Œåˆ™ç”¨ä¿®æ”¹å€¼æ›¿æ¢å†…å­˜åœ°å€å®é™…å€¼ï¼Œæ­¤æ—¶CASåŸè¯­æ“ä½œæˆåŠŸã€‚è€Œå¤±è´¥åé‡æ–°å°è¯•çš„è¿‡ç¨‹è¢«ç§°ä¸º<strong>è‡ªæ—‹</strong>ã€‚è¿™æ˜¯ä¹è§‚é”çš„ä¸€ç§ï¼Œå…¶é€‚ç”¨äºä¸´ç•ŒåŒºæ¯”è¾ƒå°ã€å¹¶å‘é‡æ¯”è¾ƒä½çš„æƒ…å†µã€‚å½“ä¸´ç•ŒåŒºæ¯”è¾ƒå¤§ã€å¹¶å‘é‡æ¯”è¾ƒé«˜æ—¶ï¼Œç”¨äº’æ–¥é”ä¸ºæ›´å¥½çš„é€‰æ‹©ã€‚</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230318213221.png"></p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230321193134.png"></p><p>è€Œä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤çš„æ¨¡æ¿ç±»å‹ä¾¿æ˜¯  <code>_S_atomic</code> ï¼Œå› æ­¤ shared_ptr å†…éƒ¨çš„å¼•ç”¨è®¡æ•°æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><h4 id="å¾ªç¯å¼•ç”¨é—®é¢˜"><a href="#å¾ªç¯å¼•ç”¨é—®é¢˜" class="headerlink" title="å¾ªç¯å¼•ç”¨é—®é¢˜"></a>å¾ªç¯å¼•ç”¨é—®é¢˜</h4><p>ä½†æ˜¯ï¼Œå½“ä¸¤ä¸ªç±»äº’ç›¸å­˜æœ‰æŒ‡å‘å¯¹æ–¹çš„shared_ptræ—¶ï¼Œææ„æ—¶ä¼šå¯¼è‡´å¼•ç”¨è®¡æ•°å‡ä¸º1ï¼ŒåŒæ–¹çš„èµ„æºéƒ½æ— æ³•é‡Šæ”¾ã€‚</p><p>å¦‚ä¸‹æ‰€ç¤º</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">B</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>B<span class="token operator">&gt;</span> pb<span class="token punctuation">;</span>  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>A<span class="token operator">&gt;</span> pa<span class="token punctuation">;</span>  <span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class B\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class B\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">auto</span> a <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>A<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">auto</span> b <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>B<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  a<span class="token operator">-&gt;</span>pb <span class="token operator">=</span> b<span class="token punctuation">;</span>  b<span class="token operator">-&gt;</span>pa <span class="token operator">=</span> a<span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>create class A<br>create class B</p><p>å¯è§ææ„å‡½æ•°å¹¶æ²¡æœ‰å¹¶æ²¡æœ‰è¢«è°ƒç”¨ã€‚è¿™ä¸ªé—®é¢˜éœ€è¦ç”¨åé¢è¯´åˆ°çš„weak_ptrè§£å†³ã€‚</p><h4 id="enable-shared-from-this"><a href="#enable-shared-from-this" class="headerlink" title="enable_shared_from_this"></a>enable_shared_from_this</h4><p>å½“ä¸€ä¸ªå¯¹è±¡éœ€è¦ä»å†…éƒ¨è·å–ä¸€ä¸ªæŒ‡å‘è‡ªå·±çš„ <code>std::shared_ptr</code> æ—¶ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§æ–¹æ³•</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Test<span class="token operator">&gt;</span> <span class="token function">getPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">shared_ptr</span><span class="token generic class-name"><span class="token operator">&lt;</span>Test<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†è‹¥è¯¥å¯¹è±¡å·²ç»è¢«ä¸€ç»„å…±äº«æŒ‡é’ˆæŒ‡å‘ï¼Œè¿™æ ·è¿”å›ä¾¿ä¼šé‡æ–°åˆ›å»ºä¸€ç»„å…±äº«æŒ‡é’ˆã€‚è¿™æ ·ï¼Œæœ€åææ„æ—¶ä¾¿ä¼šå¯¹Testå¯¹è±¡è¿›è¡Œä¸¤æ¬¡deleteï¼Œå‘ç”Ÿé”™è¯¯ã€‚</p><p>è¿™ç§é”™è¯¯å¯ä»¥é€šè¿‡åœ¨ç±»ä¸­ä¿å­˜ä¸€ä¸ª weak_ptr æˆå‘˜æ¥é¿å…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡å‡†åº“çš„enable_shared_from_thisè§£å†³ã€‚</p><p>æ ‡å‡†åº“æä¾›äº†ä¸€ç§ä½¿ç”¨ CRTP(<strong>C</strong>uriously <strong>R</strong>ecurring <strong>T</strong>emplate <strong>P</strong>attern) æ–¹æ³•çš„åŸºç±»æ¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¤§è‡´å¦‚ä¸‹ä½¿ç”¨</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Test</span> <span class="token operator">:</span> <span class="token base-clause">std<span class="token double-colon punctuation">::</span><span class="token class-name">enable_shared_from_this</span><span class="token operator">&lt;</span><span class="token class-name">Test</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Test<span class="token operator">&gt;</span> <span class="token function">getPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">shared_from_this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ä¸€ä¸ªç±»ç»§æ‰¿è‡ª <code>enable_shared_from_this</code> æ—¶ï¼Œè¿™ä¸ªç±»çš„å®ä¾‹åœ¨åˆ›å»ºæ—¶ï¼Œä¼šé¢å¤–åˆ†é…ä¸€ä¸ª <code>weak_ptr</code> ç±»å‹çš„æ•°æ®æˆå‘˜ <code>_weak_this</code>ï¼Œç”¨æ¥è®°å½•ä¸€ä¸ªå¼±å¼•ç”¨ï¼ˆweak referenceï¼‰æŒ‡å‘è‡ªèº«ã€‚åŒæ—¶ï¼Œ<code>enable_shared_from_this</code> è¿˜æä¾›äº†ä¸€ä¸ª <code>shared_from_this()</code> æ–¹æ³•ï¼Œç”¨æ¥è¿”å›ä¸€ä¸ªæŒ‡å‘è‡ªèº«çš„ <code>shared_ptr</code>ã€‚</p><p>å½“è°ƒç”¨ <code>shared_from_this()</code> æ–¹æ³•æ—¶ï¼Œå®ƒä¼šå…ˆæ£€æŸ¥ <code>_weak_this</code> æ˜¯å¦å·²ç»è¢«åˆå§‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå°±æŠ›å‡ºä¸€ä¸ª <code>std::bad_weak_ptr</code> å¼‚å¸¸ã€‚å¦åˆ™ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘è‡ªèº«çš„ <code>shared_ptr</code>ï¼Œè¿™ä¸ª <code>shared_ptr</code> çš„è®¡æ•°å™¨ä¼šä¸æ‰€æœ‰å…¶ä»–æŒ‡å‘è¯¥å¯¹è±¡çš„ <code>shared_ptr</code> å…±äº«ä¸€ä¸ªè®¡æ•°å™¨ã€‚</p><p><code>enable_shared_from_this</code> çš„ä¸€ä¸ªå¸¸è§ç”¨æ³•æ˜¯åœ¨å®ç°å¼‚æ­¥æ“ä½œçš„å›è°ƒå‡½æ•°ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å°†ä¸€ä¸ªå›è°ƒå‡½æ•°ç»‘å®šåˆ°ä¸€ä¸ªå¼‚æ­¥æ“ä½œä¸­ï¼Œå¹¶ä¸”å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œéœ€è¦è°ƒç”¨å›è°ƒå‡½æ•°å¹¶å°†æŸäº›æ•°æ®ä¼ é€’ç»™å®ƒã€‚å¦‚æœå›è°ƒå‡½æ•°éœ€è¦è®¿é—®å¼‚æ­¥æ“ä½œæ‰€ä½¿ç”¨çš„å¯¹è±¡ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>enable_shared_from_this</code> æ¥è·å–ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„ <code>std::shared_ptr</code>ã€‚</p><p>å¦ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯åœ¨å¯¹è±¡ä¹‹é—´å»ºç«‹å¼±å¼•ç”¨ï¼ˆweak referenceï¼‰ã€‚é€šè¿‡ <code>std::weak_ptr</code> å¯ä»¥å®ç°å¯¹è¢«ç®¡ç†å¯¹è±¡çš„å¼•ç”¨ï¼Œä½†éœ€è¦å…ˆå°†å…¶ä¸ <code>std::shared_ptr</code> ç»‘å®šã€‚è€Œé€šè¿‡ <code>enable_shared_from_this</code> å¯ä»¥æ–¹ä¾¿åœ°è·å–ä¸€ä¸ª <code>std::shared_ptr</code>ï¼Œä»è€Œé¿å…æ‰‹åŠ¨ç»´æŠ¤ <code>std::shared_ptr</code> çš„å¼•ç”¨è®¡æ•°å’Œç”Ÿå‘½å‘¨æœŸã€‚</p><h3 id="weak-ptr"><a href="#weak-ptr" class="headerlink" title="weak_ptr"></a>weak_ptr</h3><p><code>std::weak_ptr</code> ç”¨æ¥è¡¨è¾¾ä¸´æ—¶æ‰€æœ‰æƒçš„æ¦‚å¿µï¼šå½“æŸä¸ªå¯¹è±¡åªæœ‰å­˜åœ¨æ—¶æ‰éœ€è¦è¢«è®¿é—®ï¼Œè€Œä¸”éšæ—¶å¯èƒ½è¢«ä»–äººåˆ é™¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>std::weak_ptr</code> æ¥è·Ÿè¸ªè¯¥å¯¹è±¡ã€‚éœ€è¦è·å¾—ä¸´æ—¶æ‰€æœ‰æƒæ—¶ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸º <code>std::shared_ptr</code>ï¼Œæ­¤æ—¶å¦‚æœåŸæ¥çš„ <code>std::shared_ptr</code> è¢«é”€æ¯ï¼Œåˆ™è¯¥å¯¹è±¡çš„ç”Ÿå‘½æœŸå°†è¢«å»¶é•¿è‡³è¿™ä¸ªä¸´æ—¶çš„ <code>std::shared_ptr</code> åŒæ ·è¢«é”€æ¯ä¸ºæ­¢ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>std<span class="token double-colon punctuation">::</span>weak_ptr<span class="token operator">&lt;</span>A<span class="token operator">&gt;</span> gw<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"use_count == "</span> <span class="token operator">&lt;&lt;</span> gw<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> spt <span class="token operator">=</span> gw<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ä½¿ç”¨ä¹‹å‰å¿…é¡»å¤åˆ¶åˆ° shared_ptr</span>    spt<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"gw is expired\n"</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">{</span>    <span class="token keyword">auto</span> sp <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>A<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    gw <span class="token operator">=</span> sp<span class="token punctuation">;</span>    <span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>create class A<br>use_count == 1: class A<br>delete class A<br>use_count == 0: gw is expired</p><p><code>std::weak_ptr</code> çš„å¦ä¸€ç”¨æ³•æ˜¯æ‰“æ–­ <code>std::shared_ptr</code> æ‰€ç®¡ç†çš„å¯¹è±¡ç»„æˆçš„ç¯çŠ¶å¼•ç”¨ã€‚è‹¥è¿™ç§ç¯è¢«å­¤ç«‹ï¼ˆä¾‹å¦‚æ— æŒ‡å‘ç¯ä¸­çš„å¤–éƒ¨å…±äº«æŒ‡é’ˆï¼‰ï¼Œåˆ™ <code>shared_ptr</code> å¼•ç”¨è®¡æ•°æ— æ³•æŠµè¾¾é›¶ï¼Œè€Œå†…å­˜è¢«æ³„éœ²ã€‚èƒ½ä»¤ç¯ä¸­çš„æŒ‡é’ˆä¹‹ä¸€ä¸ºå¼±æŒ‡é’ˆä»¥é¿å…æ­¤æƒ…å†µã€‚</p><p>ä¸Šé¢<code>shared_ptr</code>å¾ªç¯å¼•ç”¨çš„ä¾‹å­è¿™æ ·ä¿®æ”¹åï¼Œä¾¿å¯ä»¥æ­£å¸¸é‡Šæ”¾èµ„æº</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">B</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>B<span class="token operator">&gt;</span> pb<span class="token punctuation">;</span>  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class A\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>weak_ptr<span class="token operator">&lt;</span>A<span class="token operator">&gt;</span> pa<span class="token punctuation">;</span>  <span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"create class B\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"delete class B\n"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">auto</span> a <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>A<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">auto</span> b <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>B<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  a<span class="token operator">-&gt;</span>pb <span class="token operator">=</span> b<span class="token punctuation">;</span>  b<span class="token operator">-&gt;</span>pa <span class="token operator">=</span> a<span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><p>create class A<br>create class B<br>delete class A<br>delete class B</p><h2 id="æ™ºèƒ½æŒ‡é’ˆçš„åˆ›å»º"><a href="#æ™ºèƒ½æŒ‡é’ˆçš„åˆ›å»º" class="headerlink" title="æ™ºèƒ½æŒ‡é’ˆçš„åˆ›å»º"></a>æ™ºèƒ½æŒ‡é’ˆçš„åˆ›å»º</h2><p>ã€ŠEffective Modern C++ã€‹ä¸­çš„æ¡æ¬¾ 21æœ‰å†™åˆ°ï¼šä¼˜å…ˆä½¿ç”¨ std::make_unique å’Œ std::make_shared è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨newï¼Œåœ¨ä¸Šé¢çš„æ‰€æœ‰ä»£ç çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä¹Ÿéƒ½éµå®ˆäº†è¿™ä¸€æ¡æ¬¾ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢ï¼Ÿ</p><h3 id="ä¸€ã€é¿å…ä»£ç é‡å¤"><a href="#ä¸€ã€é¿å…ä»£ç é‡å¤" class="headerlink" title="ä¸€ã€é¿å…ä»£ç é‡å¤"></a>ä¸€ã€é¿å…ä»£ç é‡å¤</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> a <span class="token operator">=</span> <span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>VeryLongClass<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>unique_ptr<span class="token operator">&lt;</span>VeryLongClass<span class="token operator">&gt;</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token keyword">new</span> VeryLongClass<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è‡ªè¡Œä½“ä¼š</p><h3 id="äºŒã€ä¿è¯å¼‚å¸¸å®‰å…¨"><a href="#äºŒã€ä¿è¯å¼‚å¸¸å®‰å…¨" class="headerlink" title="äºŒã€ä¿è¯å¼‚å¸¸å®‰å…¨"></a>äºŒã€ä¿è¯å¼‚å¸¸å®‰å…¨</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">processWidget</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span> spw<span class="token punctuation">,</span> <span class="token keyword">int</span> priority<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è€ƒè™‘ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœæœ‰ä¸€ä¸ªè®¡ç®— <code>priority</code>çš„å‡½æ•°</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">computePriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‚£ä¹ˆï¼Œä¸‹é¢è¿™æ®µä»£ç å°±æœ‰å¯èƒ½å†…å­˜æ³„éœ²</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">processWidget</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">shared_ptr</span><span class="token generic class-name"><span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> Widget<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">computePriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºè¿›å…¥ <code>processWidget</code>  å‰ï¼ŒåŒ…å«ä¸‰æ­¥æ“ä½œ</p><p>æ‰§è¡Œnew Widgetï¼Œæ‰§è¡ŒcomputePriorityï¼Œæ‰§è¡Œstd::shared_ptrçš„æ„é€ å‡½æ•°</p><p>ä½†è¿™ä¸‰æ­¥é¡ºåºæ˜¯ä¸ä¸€å®šçš„ï¼Œå¦‚æœ <code>computePriority</code>  å…ˆæ‰§è¡Œï¼Œé‚£ä¹ˆå½“å…¶å‘ç”Ÿå¼‚å¸¸ï¼Œå°±æ— äº‹å‘ç”Ÿã€‚</p><p>ä½†æ˜¯å¦‚æœæ‰§è¡Œé¡ºåºä¸Šé¢æ‰€åˆ—çš„é¡ºåºä¸€æ ·ï¼Œé‚£ä¹ˆå½“ <code>computePriority</code> å‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆnewå‡ºæ¥çš„Widgetå°±ä¼šå‘ç”Ÿå†…å­˜æ³„éœ²ï¼Œå› ä¸ºå®ƒæ°¸è¿œä¸ä¼šå­˜å‚¨åœ¨Step 3ä¸­äº§ç”Ÿçš„æœ¬åº”è´Ÿè´£ç®¡ç†å®ƒ çš„ std::shared_ptr ä¸­ã€‚</p><p>è€Œå¦‚æœä½¿ç”¨make_sharedï¼Œå¦‚ä¸‹</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">processWidget</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>computePriority<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¾¿ä¸ä¼šæœ‰å†…å­˜æ³„éœ²çš„é£é™©ã€‚åœ¨runtimeçš„æ—¶å€™ï¼Œ std::make_shared æˆ–è€…computePriorityéƒ½æœ‰å¯èƒ½è¢«ç¬¬ä¸€æ¬¡è°ƒç”¨ã€‚å¦‚æœæ˜¯ std::make_shared å…ˆè¢«è°ƒç”¨ï¼Œè¢«åŠ¨æ€åˆ†é…çš„Widgetå®‰å…¨çš„å­˜å‚¨åœ¨è¿”å›çš„ std::shared_ptr ä¸­ (åœ¨computePriorityè¢«è°ƒç”¨ä¹‹å‰)ã€‚å¦‚æœcomputePriorityäº§ç”Ÿäº†å¼‚å¸¸ï¼Œ std::shared_ptr çš„ææ„å‡½æ•°ä¼šè´Ÿè´£æŠŠå®ƒæ‰€æ‹¥æœ‰çš„Widgetå›æ”¶ã€‚å¦‚æœcomputePriorityé¦–å…ˆè¢«è°ƒç”¨å¹¶ä¸”äº§ç”Ÿå‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œ std::make_shared ä¸ä¼šè¢«è°ƒç”¨ï¼Œå› æ­¤ä¹Ÿä¸å¿…æ‹…å¿ƒåŠ¨æ€åˆ†é…çš„Widgetä¼šäº§ç”Ÿæ³„æ¼çš„é—®é¢˜ã€‚</p><h3 id="ä¸‰ã€æå‡æ•ˆç‡"><a href="#ä¸‰ã€æå‡æ•ˆç‡" class="headerlink" title="ä¸‰ã€æå‡æ•ˆç‡"></a>ä¸‰ã€æå‡æ•ˆç‡</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span> <span class="token function">spw</span><span class="token punctuation">(</span><span class="token keyword">new</span> Widget<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾ˆæ˜æ˜¾çš„æƒ…å†µæ˜¯ä»£ç åªéœ€ä¸€æ¬¡å†…å­˜åˆ†é…ï¼Œä½†å®é™…ä¸Šå®ƒæ‰§è¡Œäº†ä¸¤æ¬¡ã€‚æ¯ä¸€ä¸ª std::shared_ptrï¼Œéƒ½æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«è¢«æŒ‡å‘å¯¹è±¡çš„å¼•ç”¨è®¡æ•°çš„æ§åˆ¶å—ï¼Œæ§åˆ¶å—çš„åˆ†é…å·¥ä½œåœ¨ std::shared_ptr çš„æ„é€ å‡½æ•°å†…éƒ¨å®Œæˆã€‚ç›´æ¥ä½¿ç”¨newï¼Œå°±éœ€è¦ä¸€æ¬¡ä¸ºWidgetåˆ†é…å†…å­˜ï¼Œç¬¬äºŒæ¬¡éœ€è¦ä¸ºæ§åˆ¶å—åˆ†é…å†…å­˜ã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ std::make_shared</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> spw <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>Widget<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸€æ¬¡åˆ†é…è¶³å¤Ÿäº†ã€‚è¿™æ˜¯å› ä¸ºstd::make_sharedåˆ†é…äº†ä¸€æ•´å—ç©ºé—´ï¼ŒåŒ…å«äº†Widgetå¯¹è±¡å’Œæ§åˆ¶å—ã€‚è¿™ä¸ªä¼˜åŒ–å‡å°‘äº†ç¨‹åºçš„é™æ€å¤§å°ï¼Œå› ä¸ºä»£ç ä¸­åªåŒ…å«äº†ä¸€æ¬¡åˆ†é…è°ƒç”¨ï¼Œå¹¶ä¸”åŠ å¿«äº†ä»£ç çš„æ‰§è¡Œé€Ÿåº¦ï¼Œå› ä¸ºå†…å­˜åªè¢«åˆ†é…ä¸€æ¬¡ã€‚æ­¤å¤–ï¼Œä½¿ç”¨std::make_shared é¿å…äº†åœ¨æ§åˆ¶å—ä¸­é¢å¤–æ·»åŠ çš„ä¸€äº›è®°å½•ä¿¡æ¯çš„éœ€è¦ï¼Œæ½œåœ¨çš„å‡å°‘äº†ç¨‹åºæ‰€éœ€çš„æ€»å†…å­˜æ¶ˆè€—ã€‚</p><p>å½“ç„¶ï¼Œmakeä¹‹ç±»çš„å‡½æ•°ä¹Ÿæœ‰ä¸€å®šçš„ç¼ºé™·ï¼Œæ¯”å¦‚ä¸æ”¯æŒæŒ‡å®šè‡ªå®šä¹‰çš„deleterã€‚</p><h2 id="æ·±å…¥ç†è§£"><a href="#æ·±å…¥ç†è§£" class="headerlink" title="æ·±å…¥ç†è§£"></a>æ·±å…¥ç†è§£</h2><p>æ·±å…¥ç†è§£ä¸€æ ·ä¸œè¥¿æœ€å¥½çš„åŠæ³•ï¼Œå°±æ˜¯å®ç°å®ƒã€‚</p><h3 id="unique-ptr-1"><a href="#unique-ptr-1" class="headerlink" title="unique_ptr"></a>unique_ptr</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token keyword">class</span> <span class="token class-name">unique_ptr</span> <span class="token punctuation">{</span> <span class="token keyword">public</span><span class="token operator">:</span>  <span class="token keyword">explicit</span> <span class="token function">unique_ptr</span><span class="token punctuation">(</span>T <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ptr_</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">unique_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">delete</span> ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token function">unique_ptr</span><span class="token punctuation">(</span><span class="token keyword">const</span> unique_ptr <span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>  unique_ptr <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> unique_ptr <span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>  T <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span>ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    T <span class="token operator">*</span>ptr <span class="token operator">=</span> ptr_<span class="token punctuation">;</span>    ptr_ <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ptr<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">private</span><span class="token operator">:</span>  T <span class="token operator">*</span>ptr_<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>unique_ptr</code> åŒ…å«ä¸€ä¸ªæŒ‡å‘ T ç±»å‹å¯¹è±¡çš„æŒ‡é’ˆ _ptrã€‚å®ƒçš„æ„é€ å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶åŒ…è£…åœ¨ <code>unique_ptr</code> å¯¹è±¡ä¸­ã€‚åœ¨ææ„å‡½æ•°ä¸­ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ delete æ“ä½œæ¥é”€æ¯å¯¹è±¡ã€‚åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢æ‹·è´å’Œèµ‹å€¼ï¼Œæˆ‘ä»¬ç¦æ­¢äº† <code>unique_ptr</code> çš„æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼æ“ä½œç¬¦ã€‚ä¸ºäº†è®© <code>unique_ptr</code> ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼Œæˆ‘ä»¬è¿˜é‡è½½äº† operator* å’Œ operator-&gt; è¿ç®—ç¬¦ï¼Œä»¥åŠæä¾›äº† get() å’Œ release() æ–¹æ³•ã€‚</p><h3 id="shared-ptr-1"><a href="#shared-ptr-1" class="headerlink" title="shared_ptr"></a>shared_ptr</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token keyword">class</span> <span class="token class-name">RefCounter</span> <span class="token punctuation">{</span> <span class="token keyword">public</span><span class="token operator">:</span>  <span class="token keyword">explicit</span> <span class="token function">RefCounter</span><span class="token punctuation">(</span>T <span class="token operator">*</span>ptr<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ptr_</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count_</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">RefCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">delete</span> ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">addRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">++</span>count_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token operator">--</span>count_<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>count_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> ptr_ <span class="token operator">?</span> count_ <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">private</span><span class="token operator">:</span>  T <span class="token operator">*</span>ptr_<span class="token punctuation">;</span>  <span class="token keyword">int</span> count_<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token keyword">class</span> <span class="token class-name">shared_ptr</span> <span class="token punctuation">{</span> <span class="token keyword">public</span><span class="token operator">:</span>  <span class="token keyword">explicit</span> <span class="token function">shared_ptr</span><span class="token punctuation">(</span>T <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token generic-function"><span class="token function">RefCounter</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token function">shared_ptr</span><span class="token punctuation">(</span><span class="token keyword">const</span> shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>counter_<span class="token punctuation">)</span> <span class="token punctuation">{</span>    counter_<span class="token operator">-&gt;</span><span class="token function">addRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">shared_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> counter_<span class="token operator">-&gt;</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">int</span> <span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> counter_<span class="token operator">-&gt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> counter_<span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>counter_<span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">private</span><span class="token operator">:</span>  RefCounter<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">*</span>counter_<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¸å¿ƒç‚¹åœ¨äºå¼•ç”¨è®¡æ•°çš„å®ç°ï¼Œè€Œåªæœ‰ä¸€ä¸ªç±»çš„è¯ï¼Œå…¶è‡ªèº«æ˜¯æ— æ³•å®Œæˆçš„ï¼Œéœ€è¦å€ŸåŠ©äºä¸€ä¸ªè®¡æ•°ç±»</p><p><code>use_count</code> æ–¹æ³•è¿”å›å½“å‰æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡è¢«å¤šå°‘æŒ‡é’ˆå…±äº«</p><h3 id="weak-ptr-1"><a href="#weak-ptr-1" class="headerlink" title="weak_ptr"></a>weak_ptr</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token keyword">class</span> <span class="token class-name">weak_ptr</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token keyword">class</span> <span class="token class-name">RefCounter</span> <span class="token punctuation">{</span> <span class="token keyword">public</span><span class="token operator">:</span>  <span class="token keyword">explicit</span> <span class="token function">RefCounter</span><span class="token punctuation">(</span>T <span class="token operator">*</span>ptr<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ptr_</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count_</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">weak_count_</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">addRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">++</span>count_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>count_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">delete</span> ptr_<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>weak_count_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">weak_release</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>weak_count_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">void</span> <span class="token function">add_weak_reference</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">++</span>weak_count_<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> ptr_ <span class="token operator">?</span> count_ <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> ptr_<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">private</span><span class="token operator">:</span>  T <span class="token operator">*</span>ptr_<span class="token punctuation">;</span>  <span class="token keyword">int</span> count_<span class="token punctuation">;</span>  <span class="token keyword">int</span> weak_count_<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token keyword">class</span> <span class="token class-name">shared_ptr</span> <span class="token punctuation">{</span> <span class="token keyword">public</span><span class="token operator">:</span>  <span class="token keyword">explicit</span> <span class="token function">shared_ptr</span><span class="token punctuation">(</span>T <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token generic-function"><span class="token function">RefCounter</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token function">shared_ptr</span><span class="token punctuation">(</span><span class="token keyword">const</span> shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>counter_<span class="token punctuation">)</span> <span class="token punctuation">{</span>    counter_<span class="token operator">-&gt;</span><span class="token function">addRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">shared_ptr</span><span class="token punctuation">(</span><span class="token keyword">const</span> weak_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>counter_<span class="token punctuation">)</span> <span class="token punctuation">{</span>    counter_<span class="token operator">-&gt;</span><span class="token function">addRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">shared_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> counter_<span class="token operator">-&gt;</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">int</span> <span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> counter_<span class="token operator">-&gt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">*</span><span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> counter_<span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  T <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>counter_<span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">private</span><span class="token operator">:</span>  RefCounter<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">*</span>counter_<span class="token punctuation">;</span>  <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">weak_ptr</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token keyword">class</span> <span class="token class-name">weak_ptr</span> <span class="token punctuation">{</span> <span class="token keyword">public</span><span class="token operator">:</span>  <span class="token function">weak_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token keyword">explicit</span> <span class="token function">weak_ptr</span><span class="token punctuation">(</span><span class="token keyword">const</span> shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>sp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">counter_</span><span class="token punctuation">(</span>sp<span class="token punctuation">.</span>counter_<span class="token punctuation">)</span> <span class="token punctuation">{</span>    counter_<span class="token operator">-&gt;</span><span class="token function">add_weak_reference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token operator">~</span><span class="token function">weak_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> counter_<span class="token operator">-&gt;</span><span class="token function">weak_release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">shared_ptr</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">shared_ptr</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span>nodiscard<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">bool</span> <span class="token function">expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> counter_ <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">or</span> counter_<span class="token operator">-&gt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">private</span><span class="token operator">:</span>  RefCounter<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">*</span>counter_<span class="token punctuation">;</span>  <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">shared_ptr</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œ<code>weak_ptr</code> ç±»åŒ…å«ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„è£¸æŒ‡é’ˆ <code>ptr_</code> å’Œä¸€ä¸ªæŒ‡å‘è®¡æ•°å™¨å¯¹è±¡çš„æŒ‡é’ˆ <code>counter_</code>ã€‚åŒæ—¶ï¼Œå®ƒè¿˜åŒ…å«äº† <code>lock()</code> æ–¹æ³•å’Œ <code>expired()</code> æ–¹æ³•ã€‚</p><p><code>lock()</code> æ–¹æ³•ç”¨äºå°† <code>weak_ptr</code> è½¬æ¢ä¸ºä¸€ä¸ª <code>shared_ptr</code> å¯¹è±¡ï¼Œå¦‚æœæŒ‡å‘å¯¹è±¡çš„ <code>shared_ptr</code> å·²ç»å¤±æ•ˆï¼Œè¿”å›ä¸€ä¸ªç©ºçš„ <code>shared_ptr</code>ã€‚</p><p><code>expired()</code> æ–¹æ³•ç”¨äºåˆ¤æ–­æŒ‡å‘çš„ <code>shared_ptr</code> å¯¹è±¡æ˜¯å¦å·²ç»å¤±æ•ˆã€‚å¦‚æœ <code>counter_</code> æŒ‡é’ˆä¸ºç©ºæˆ–è€…è®¡æ•°å™¨å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å·²ç»ä¸ºé›¶ï¼Œåˆ™è¡¨ç¤ºæŒ‡å‘çš„ <code>shared_ptr</code> å¯¹è±¡å·²ç»å¤±æ•ˆã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>weak_ptr</code> å¿…é¡»ä¸ <code>shared_ptr</code> å…±ç”¨åŒä¸€ä¸ªè®¡æ•°å™¨å¯¹è±¡ï¼Œå› æ­¤åœ¨æ„é€ å‡½æ•°ä¸­éœ€è¦å°† <code>shared_ptr</code> å¯¹è±¡çš„æŒ‡é’ˆå’Œè®¡æ•°å™¨å¯¹è±¡çš„æŒ‡é’ˆéƒ½ä¿å­˜ä¸‹æ¥ã€‚</p><p>æ­¤å¤„æ ‡å‡†åº“å®ç°æ˜¯é‡‡å–ä¸€ä¸ªå¼ºè®¡æ•°ä¸ä¸€ä¸ªå¼±è®¡æ•°ï¼Œå¼ºè®¡æ•°ä¸º0åˆ™é‡Šæ”¾èµ„æºï¼Œå¼±è®¡æ•°ä¸º0åˆ™ææ„è®¡æ•°ç±»ã€‚</p><h2 id="å¼ƒç”¨çš„auto-ptr"><a href="#å¼ƒç”¨çš„auto-ptr" class="headerlink" title="å¼ƒç”¨çš„auto_ptr"></a>å¼ƒç”¨çš„auto_ptr</h2><p>ä»å¤±è´¥ä¸­å¸å–æ•™è®­ï¼Œæ‰èƒ½å¤ŸæˆåŠŸã€‚auto_pträ¾¿æ˜¯C++å§”å‘˜ä¼šå¸å–çš„ä¸€æ¬¡æ•™è®­ã€‚</p><p>å®ƒçš„æƒ³æ³•å’Œunique_pträ¸€æ ·ï¼Œå°±æ˜¯ç”¨æ¥ç‹¬ç«‹åœ°ç®¡ç†å†…å­˜ã€‚ä½†æ˜¯åœ¨C++11ä¹‹å‰ï¼Œè¿˜æ²¡æœ‰ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨ã€‚é‚£æ˜¯æ€æ ·å®ç°ç‹¬ç«‹ç®¡ç†å†…å­˜çš„å‘¢ï¼Ÿ</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230320200952.png"></p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230320201053.png"></p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230320201118.png"></p><p>ä¸Šé¢è¿™äº›ç©æ„åœ¨ä¸€èµ·ï¼Œå°±ä¼šè¾¾æˆè¿™æ ·ä¸€ä¸ªæ•ˆæœã€‚å½“ä½ å†™ä¸‹å¦‚ä¸‹è¯­å¥æ—¶</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">auto_ptr<span class="token operator">&lt;</span>mother<span class="token operator">&gt;</span> a<span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">b</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> c<span class="token punctuation">;</span>c <span class="token operator">=</span> b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä½  <code>a</code> å’Œ <code>b</code> çš„ mother å°±æ²¡äº†ï¼ï¼ï¼ï¼</p><p><code>auto b(a); </code> è¿™ä¸ªä»£ç ï¼Œaå°†å¯¹è±¡æ‰€æœ‰æƒè½¬ç§»ç»™äº†bï¼Œè‡ªå·±ç½®ç©ºäº†ã€‚</p><p><code>c = b;</code> è¿™ä¸ªä»£ç ï¼Œbå°†å¯¹è±¡æ‰€æœ‰æƒè½¬ç§»ç»™äº†cï¼Œè‡ªå·±ç½®ç©ºäº†ã€‚</p><p>ä½†è¿™è¿˜ä¸æ˜¯æœ€ç‹ çš„ï¼Œçœ‹ä¸‹é¢çš„ä»£ç </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span>auto_ptr<span class="token operator">&lt;</span>mother<span class="token operator">&gt;&gt;</span> a<span class="token punctuation">;</span>  <span class="token comment">// ...Some code to input a</span><span class="token function">sort</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>auto_ptr<span class="token operator">&lt;</span>mother<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> auto_ptr<span class="token operator">&lt;</span>mother<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>B<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> A<span class="token operator">-&gt;</span>a <span class="token operator">&lt;</span> B<span class="token operator">-&gt;</span>a<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€è¶Ÿæ’åºä¸‹æ¥ï¼Œç”±äºå†…éƒ¨çš„swapæ“ä½œï¼Œå¾ˆå¤šæŒ‡é’ˆçš„ mother éƒ½æ²¡äº†ï¼ï¼ï¼ï¼ï¼</p><p>å› æ­¤ï¼Œåœ¨C++11ä¸­ï¼Œä¸ºäº†å®Œå–„ç±»å‹ç³»ç»Ÿï¼Œä½¿è¯­æ³•æ›´åŠ ä¼˜é›…ï¼Œä½¿å€¼çš„ä¼ é€’æ›´åŠ é«˜æ•ˆï¼Œå‡å°‘æ‹·è´ç­‰ç­‰ï¼Œå¼•å…¥äº†ä¼Ÿå¤§çš„å³å€¼å¼•ç”¨ä¸ç§»åŠ¨è¯­ä¹‰ï¼ï¼ï¼</p><p>ç°åœ¨ swap æ˜¯è¿™æ ·å®ç°çš„</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230320204941.png"></p><p>è€Œ auto_ptr ä¹Ÿè¢«æ›´æ¢æˆäº† unique_ptrã€‚åˆ°æ­¤ï¼Œauto_ptrçš„å†å²å°±ç»“æŸäº†ã€‚</p><h2 id="ç½•è§çš„ç”¨æ³•"><a href="#ç½•è§çš„ç”¨æ³•" class="headerlink" title="ç½•è§çš„ç”¨æ³•"></a>ç½•è§çš„ç”¨æ³•</h2><p>å‰é¢éƒ½æ˜¯ç®¡ç†å•ä¸ªå¯¹è±¡ï¼Œå…¶å®æ™ºèƒ½æŒ‡é’ˆè¿˜èƒ½ç®¡ç†æ•°ç»„å¯¹è±¡</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230320205547.png"></p><p>è¿™æ ·å­ç”¨çš„è¯ï¼Œptr çš„æ¨¡æ¿ç±»å‹æ˜¯è¿™ä¸ª</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230320205626.png"></p><p>æœ‰äº›äººå¯èƒ½ä¼šè§‰å¾—è¿™ä¸ºä»€ä¹ˆä¼šç½•è§å‘¢ï¼Ÿå‘ƒï¼Œå¯èƒ½æ˜¯å› ä¸ºæœ‰äº†vectoräº†ã€‚åæ­£æˆ‘å¾ˆå°‘åœ¨å®é™…é¡¹ç›®ä¸­çœ‹åˆ°ã€‚</p><h2 id="ä¸ªäººçš„ç†è§£"><a href="#ä¸ªäººçš„ç†è§£" class="headerlink" title="ä¸ªäººçš„ç†è§£"></a>ä¸ªäººçš„ç†è§£</h2><p>unique_ptr ç»è¿‡ç¼–è¯‘å™¨ä¼˜åŒ–ä»¥åæ˜¯å®Œå…¨é›¶å¼€é”€çš„ï¼Œå¯ä»¥æ”¾å¿ƒå¤§èƒ†åœ°ä½¿ç”¨å®ƒæ¥ç®¡ç†èµ„æºã€‚</p><p>ä½† shared_ptr å…¶å†…éƒ¨çš„åŸå­è®¡æ•°å¯¹äºæ€§èƒ½æ˜¯æœ‰ä¸€å®šçš„å½±å“çš„ï¼Œè€Œå…¶è§£å†³æ–¹æ¡ˆenable_shared_from_thisç”¨ä¾‹ä¸‹ï¼ŒåŸºäºshared_ptrçš„è§£å†³æ–¹æ¡ˆä¹Ÿå¹¶éæ˜¯éä¾µå…¥å¼çš„ã€‚å¹¶ä¸”ï¼Œå…¶è¿˜å…·æœ‰ä¼ æ’­æ€§ï¼Œå½“åœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨åï¼Œä¼ å…¥ä¼ å‡ºå…¶ä»–åœ°æ–¹ï¼Œå¾€å¾€åˆéœ€è¦shared_ptrï¼ˆå¦åˆ™å¯¹è±¡èµ„æºé‡Šæ”¾ä¼šä¸æ­£ç¡®ï¼‰ï¼Œæœ€åæ•´ä¸ªé¡¹ç›®ä¾¿åˆ°å¤„æ˜¯shared_ptrã€‚æ‰€ä»¥ä½¿ç”¨æ—¶ä¸€å®šè¦å°å¿ƒï¼Œè¦å°‘ç”¨ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•å‡å°‘shared_ptrçš„ä½¿ç”¨å‘¢ï¼Ÿå…¶å®ä»”ç»†æ£€è§†ä¸€ä¸‹æ•´ä¸ªå¼‚æ­¥æµç¨‹ï¼Œæœ‰äº›èµ„æºè™½ç„¶ä¼šå…ˆåè¢«ä¸åŒçš„å¯¹è±¡æ‰€å¼•ç”¨ï¼Œä½†åœ¨å…¶æ•´ä¸ªç”Ÿå­˜å‘¨æœŸå†…ï¼Œæ¯ä¸€æ—¶åˆ»éƒ½åªæœ‰ä¸€ä¸ªå¯¹è±¡æŒæœ‰è¯¥èµ„æºçš„å¼•ç”¨ã€‚ç”¨äºæ•°æ®æ”¶å‘çš„ç¼“å†²åŒºå¯¹è±¡å°±æ˜¯ä¸€ä¸ªå…¸å‹ã€‚å®ƒä»¬æ€»æ˜¯è¢«ä»æŸä¸ªæºå¤´äº§ç”Ÿï¼Œç„¶åä¾¿ä¸€ç›´ä»ä¸€å¤„è¢«ä¼ é€’åˆ°å¦ä¸€å¤„ï¼Œæœ€ç»ˆåœ¨æŸä¸ªæ—¶åˆ»è¢«å›æ”¶ã€‚</p><p>å¯¹äºè¿™æ ·çš„å¯¹è±¡ï¼Œå®é™…ä¸Šæ²¡æœ‰å¿…è¦é’ˆå¯¹æµç¨‹ä¸­çš„æ¯ä¸€æ¬¡æ‰€æœ‰æƒè½¬ç§»éƒ½è¿›è¡Œå¼•ç”¨è®¡æ•°æ“ä½œï¼Œåªè¦ç®€å•åœ°åœ¨åˆ†é…æ—¶å°†å¼•ç”¨è®¡æ•°ç½®1ï¼Œåœ¨éœ€è¦é‡Šæ”¾æ—¶å†å°†å¼•ç”¨è®¡æ•°å½’é›¶ä¾¿å¯ä»¥äº†ã€‚</p><p>å‚è€ƒï¼š</p><p>chatGPT</p><p>cppreference</p><p><a href="https://mp.weixin.qq.com/s/deG0GHRpz4Qgq4cLSiW6-g">ã€ŠC++ å…±äº«æŒ‡é’ˆå››å®—ç½ªã€‹</a></p><p>ã€ŠEffective Modern C++ã€‹</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­è¨€é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç»ˆç«¯ç¾åŒ–: zsh</title>
      <link href="/linux-zhong-duan-mei-hua-zsh/"/>
      <url>/linux-zhong-duan-mei-hua-zsh/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©å­¦C++åç¨‹æ—¶ï¼Œå¶ç„¶å‘ç°è§†é¢‘é‡Œçš„ç»ˆç«¯å¾ˆç‚«ï¼Œéå¸¸ç¬¦åˆæˆ‘å¯¹ç§‘æŠ€çš„æƒ³è±¡ï¼Œç¨å¾®æœäº†ä¸‹ï¼Œæ‰¾åˆ°äº†zsh</p><h2 id="é…ç½®æ­¥éª¤"><a href="#é…ç½®æ­¥éª¤" class="headerlink" title="é…ç½®æ­¥éª¤"></a>é…ç½®æ­¥éª¤</h2><h3 id="å®‰è£…-zsh"><a href="#å®‰è£…-zsh" class="headerlink" title="å®‰è£… zsh"></a>å®‰è£… zsh</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">zsh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯åªä¸‹è½½ä¸€ä¸ªè£¸çš„zshï¼Œé…ç½®å¾ˆéš¾ï¼Œæ‰€ä»¥æœ‰äººæŠŠé…ç½®æ•´åˆäº†</p><h3 id="å®‰è£…-Oh-My-Zsh"><a href="#å®‰è£…-Oh-My-Zsh" class="headerlink" title="å®‰è£… Oh My Zsh"></a>å®‰è£… Oh My Zsh</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sh</span> -c <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é€‰æ‹©ä¸»é¢˜"><a href="#é€‰æ‹©ä¸»é¢˜" class="headerlink" title="é€‰æ‹©ä¸»é¢˜"></a>é€‰æ‹©ä¸»é¢˜</h3><p>å¯ä»¥åœ¨è¿™<a href="https://github.com/ohmyzsh/ohmyzsh/wiki/themes">é‡Œé¢</a>é€‰è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜</p><p>æˆ‘é€‰çš„æ˜¯ <code>jonathan</code></p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230315130512.png" alt="å›¾ç‰‡"></p><p>é€‰å¥½åï¼Œåœ¨ç”¨æˆ·ç›®å½•ä¸‹çš„ <code>.zshrc</code> æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹è¿™ä¸€è¡Œå³å¯</p><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230315130949.png"></p><p>ç„¶åé‡å¯ç»ˆç«¯å°±ç”Ÿæ•ˆå•¦ï¼</p><p>zshè¿˜å¯¹è®¸å¤šå¸¸ç”¨å‘½ä»¤è¿›è¡Œäº†ç®€å†™ï¼Œå¯ä»¥ä½¿ç”¨ <code>alias</code> å‘½ä»¤æ¥æŸ¥çœ‹</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…å­˜å¯¹é½</title>
      <link href="/nei-cun-dui-qi/"/>
      <url>/nei-cun-dui-qi/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šï¼ˆç¯å¢ƒï¼š64ä½Windows 11ï¼ŒGCCï¼ŒC++20ï¼ŒO3ä¼˜åŒ–ï¼‰</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A1</span> <span class="token punctuation">{</span>  <span class="token keyword">char</span> a<span class="token punctuation">;</span>  <span class="token keyword">int</span> b<span class="token punctuation">;</span>  <span class="token keyword">char</span> c<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">A2</span> <span class="token punctuation">{</span>  <span class="token keyword">char</span> a<span class="token punctuation">;</span>  <span class="token keyword">char</span> b<span class="token punctuation">;</span>  <span class="token keyword">int</span> c<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>A1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>A2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// 12 8</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºä»€ä¹ˆä¸¤ä¸ªç»“æ„ä½“æ˜æ˜æœ‰åŒæ ·çš„å†…å®¹ï¼Œå´æœ‰ä¸åŒå¤§å°çš„å†…å­˜å‘¢ï¼Ÿå› ä¸ºå†…å­˜å¯¹é½ï¼</p><h2 id="å†…å­˜å¯¹é½è§„åˆ™"><a href="#å†…å­˜å¯¹é½è§„åˆ™" class="headerlink" title="å†…å­˜å¯¹é½è§„åˆ™"></a>å†…å­˜å¯¹é½è§„åˆ™</h2><p>1ã€æ²¡æœ‰#pragma packå®çš„å¯¹é½è§„åˆ™</p><ul><li>ç»“æ„ä½“çš„èµ·å§‹å­˜å‚¨ä½ç½®å¿…é¡»æ˜¯èƒ½å¤Ÿè¢«è¯¥ç»“æ„ä½“ä¸­æœ€å¤§çš„æ•°æ®ç±»å‹æ‰€æ•´é™¤ã€‚</li><li>æ¯ä¸ªæ•°æ®æˆå‘˜å­˜å‚¨çš„èµ·å§‹ä½ç½®æ˜¯è‡ªèº«å¤§å°çš„æ•´æ•°å€ï¼ˆæ¯”å¦‚intåœ¨64ä½æœºä¸º4å­—èŠ‚ï¼Œåˆ™intå‹æˆå‘˜è¦ä»4çš„æ•´æ•°å€åœ°å€å¼€å§‹å­˜å‚¨ï¼‰ã€‚</li><li>ç»“æ„ä½“æ€»å¤§å°ï¼ˆä¹Ÿå°±æ˜¯sizeofçš„ç»“æœï¼‰ï¼Œå¿…é¡»æ˜¯è¯¥ç»“æ„ä½“æˆå‘˜ä¸­æœ€å¤§çš„å¯¹é½æ¨¡æ•°çš„æ•´æ•°å€ã€‚è‹¥ä¸æ»¡è¶³ï¼Œä¼šæ ¹æ®éœ€è¦è‡ªåŠ¨å¡«å……ç©ºç¼ºçš„å­—èŠ‚ã€‚</li><li>ç»“æ„ä½“åŒ…å«å¦ä¸€ä¸ªç»“æ„ä½“æˆå‘˜ï¼Œåˆ™è¢«åŒ…å«çš„ç»“æ„ä½“æˆå‘˜è¦ä»å…¶åŸå§‹ç»“æ„ä½“å†…éƒ¨æœ€å¤§å¯¹é½æ¨¡æ•°çš„æ•´æ•°å€åœ°å€å¼€å§‹å­˜å‚¨ã€‚ï¼ˆæ¯”å¦‚struct aé‡Œå­˜æœ‰struct bï¼Œbé‡Œæœ‰charï¼Œintï¼Œdoubleç­‰å…ƒç´ ï¼Œé‚£båº”è¯¥ä»8çš„æ•´æ•°å€å¼€å§‹å­˜å‚¨ã€‚)</li><li>ç»“æ„ä½“åŒ…å«æ•°ç»„æˆå‘˜ï¼Œæ¯”å¦‚char a[3]ï¼Œå®ƒçš„å¯¹é½æ–¹å¼å’Œåˆ†åˆ«å†™3ä¸ªcharæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒè¿˜æ˜¯æŒ‰ä¸€ä¸ªå­—èŠ‚å¯¹é½ã€‚å¦‚æœå†™ï¼štypedef char Array[3]ï¼ŒArrayè¿™ç§ç±»å‹çš„å¯¹é½æ–¹å¼è¿˜æ˜¯æŒ‰ä¸€ä¸ªå­—èŠ‚å¯¹é½ï¼Œè€Œä¸æ˜¯æŒ‰å®ƒçš„é•¿åº¦3å¯¹é½ã€‚</li><li>ç»“æ„ä½“åŒ…å«å…±ç”¨ä½“æˆå‘˜ï¼Œåˆ™è¯¥å…±ç”¨ä½“æˆå‘˜è¦ä»å…¶åŸå§‹å…±ç”¨ä½“å†…éƒ¨æœ€å¤§å¯¹é½æ¨¡æ•°çš„æ•´æ•°å€åœ°å€å¼€å§‹å­˜å‚¨ã€‚</li></ul><p>2ã€å­˜åœ¨#pragma packå®çš„å¯¹é½</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">pack</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>    </span><span class="token comment">//ç¼–è¯‘å™¨å°†æŒ‰ç…§nä¸ªå­—èŠ‚å¯¹é½  </span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">pack</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>     </span><span class="token comment">//å–æ¶ˆè‡ªå®šä¹‰å­—èŠ‚å¯¹é½æ–¹å¼</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é‚£ä¹ˆå¯¹é½è§„åˆ™å°±å˜æˆä¸‹é¢çš„</p><ul><li>ç»“æ„ï¼Œè”åˆï¼Œæˆ–è€…ç±»çš„æ•°æ®æˆå‘˜ï¼Œç¬¬ä¸€ä¸ªæ”¾åœ¨åç§»ä¸º0çš„åœ°æ–¹ï¼Œä»¥åæ¯ä¸ªæ•°æ®æˆå‘˜çš„å¯¹é½ï¼ŒæŒ‰ç…§#pragma packæŒ‡å®šçš„æ•°å€¼å’Œè‡ªèº«å¯¹é½æ¨¡æ•°ä¸­è¾ƒå°çš„é‚£ä¸ªã€‚</li></ul><hr><p>å›åˆ°ä¸Šé¢çš„ç¨‹åºï¼ŒæŒ‰ç…§ä¸Šè¿°è§„åˆ™ï¼Œä¸¤ä¸ªç»“æ„ä½“éƒ½æŒ‰ç…§æœ€å¤§çš„æ•°æ®ç±»å‹intçš„ 4 å­—èŠ‚å¯¹é½ã€‚ç¬¬ä¸€ä¸ªç»“æ„ä½“ï¼Œcharå 1å­—èŠ‚ï¼Œç”±äºæ¥ä¸‹æ¥æ˜¯intç±»å‹çš„å››ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¼šå¡«å……ä¸º4å­—èŠ‚ï¼Œintè¿‡ååˆæœ‰ä¸€ä¸ªcharï¼Œå†æ¬¡è¢«å¡«å……4å­—èŠ‚ï¼Œæ€»å…± 4 + 4 + 4 = 12 å­—èŠ‚ã€‚ç¬¬äºŒä¸ªç»“æ„ä½“ï¼Œä¸¤ä¸ªcharå 2å­—èŠ‚ï¼Œåè·Ÿä¸€ä¸ªintï¼Œäºæ˜¯è¢«å¡«å……ä¸º4å­—èŠ‚ï¼Œæ€»å…± 4 + 4 = 8 å­—èŠ‚ã€‚</p><p>è¿™å¾ˆå¯¹ï¼Œä½†è¿™ä¸œè¥¿åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p><h2 id="å†…å­˜å¯¹é½çš„ä½œç”¨"><a href="#å†…å­˜å¯¹é½çš„ä½œç”¨" class="headerlink" title="å†…å­˜å¯¹é½çš„ä½œç”¨"></a>å†…å­˜å¯¹é½çš„ä½œç”¨</h2><p>å†…å­˜å¯¹é½åœ¨å®é™…å¼€å‘ä¸­æœ‰å¾ˆå¤šç”¨é€”ï¼Œä»¥ä¸‹æ˜¯å…¶ä¸­ä¸€äº›ï¼š</p><ol><li>æé«˜ç¨‹åºæ•ˆç‡ï¼šå†…å­˜å¯¹é½å¯ä»¥ä½¿å˜é‡å­˜å‚¨åœ¨è‡ªç„¶è¾¹ç•Œä¸Šï¼Œä»è€Œæé«˜ CPU è®¿é—®å†…å­˜çš„æ•ˆç‡ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ•ˆç‡ã€‚</li><li>ä¿è¯å†…å­˜å®‰å…¨ï¼šå½“ç»“æ„ä½“æˆ–ç±»ä¸­çš„æˆå‘˜å˜é‡æŒ‰ç…§å¯¹é½è§„åˆ™è¿›è¡Œåˆ†é…æ—¶ï¼Œå¯ä»¥ç¡®ä¿æ•°æ®ä¸ä¼šå› ä¸ºå­—èŠ‚å¯¹é½è€Œå‡ºç°é”™è¯¯çš„åç§»é‡ï¼Œä»è€Œä¿è¯å†…å­˜çš„å®‰å…¨æ€§ã€‚</li><li>èŠ‚çœå†…å­˜ç©ºé—´ï¼šé€šè¿‡å†…å­˜å¯¹é½ï¼Œå¯ä»¥ä½¿å˜é‡çš„å­˜å‚¨æ›´åŠ ç´§å‡‘ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡ï¼Œä»è€ŒèŠ‚çœå†…å­˜ç©ºé—´ã€‚</li><li>ä¼˜åŒ–ç¼“å­˜è¡Œè®¿é—®ï¼šç°ä»£ CPU é‡‡ç”¨äº†ç¼“å­˜è¡Œçš„æ¦‚å¿µï¼Œå†…å­˜å¯¹é½å¯ä»¥è®©å˜é‡å­˜å‚¨åœ¨ç›¸é‚»çš„ç¼“å­˜è¡Œä¸­ï¼Œä»è€Œæé«˜ CPU è®¿é—®ç¼“å­˜çš„æ•ˆç‡ã€‚</li><li>æ”¹å–„å¹¶è¡Œå¤„ç†æ•ˆç‡ï¼šå†…å­˜å¯¹é½å¯ä»¥æ”¹å–„å¤šçº¿ç¨‹å¹¶å‘å¤„ç†æ—¶çš„æ•ˆç‡ï¼Œå› ä¸ºå½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€å†…å­˜æ—¶ï¼Œå†…å­˜å¯¹é½å¯ä»¥å‡å°‘çº¿ç¨‹ä¹‹é—´çš„å†²çªï¼Œä»è€Œæé«˜å¹¶è¡Œå¤„ç†æ•ˆç‡ã€‚</li><li>ç¡®ä¿å…¼å®¹æ€§ï¼šä¸åŒç¼–è¯‘å™¨æˆ–æ“ä½œç³»ç»Ÿå¯èƒ½æœ‰ä¸åŒçš„å†…å­˜å¯¹é½è§„åˆ™ï¼Œå› æ­¤åœ¨å¼€å‘ä¸­éµå¾ªæ­£ç¡®çš„å†…å­˜å¯¹é½è§„åˆ™å¯ä»¥ç¡®ä¿ç¨‹åºçš„å…¼å®¹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</li></ol><p>è‡ªå®šä¹‰ç½‘ç»œé€šè®¯åè®®åŒ…é€šå¸¸éƒ½æ˜¯å®šä¹‰æˆstructçš„å½¢å¼ï¼Œ è€Œstructä¼šè‡ªåŠ¨å†…å­˜å¯¹é½ï¼Œè¿™ä¼šé€ æˆç»“æ„ä½“æˆå‘˜é—´æœ‰â€ç©ºæ´â€œï¼Œä¼ ç»™å…¶å®ƒå¹³å°åï¼Œå…¶å®ƒå¹³å°å¼„ä¸æ¸…æ¥šåŸå¹³å°æ˜¯æŒ‰ä»€ä¹ˆæ–¹å¼å¯¹é½çš„ï¼Œåªä¼šæŒ‰è‡ªå·±çš„æ–¹å¼è§£åŒ…ã€‚ è§£å‡ºæ¥çš„ç»“æœæœ‰å¯èƒ½æ˜¯é”™è¯¯çš„ã€‚ä¸ºé˜²æ­¢è¿™ç§æƒ…å†µå‡ºç°ï¼Œè‡ªå®šä¹‰é€šè®¯åè®®æ—¶ï¼Œä¸€å®šè¦è®©ç»“æ„ä½“ï¼ˆæˆ–è”åˆï¼‰æˆå‘˜é—´éƒ½æŒ‰1æ¥å¯¹é½ã€‚</p><p>æ€»ä¹‹ï¼Œå†…å­˜å¯¹é½æ˜¯ä¸€ç§é‡è¦çš„æŠ€æœ¯ï¼Œå®ƒåœ¨å®é™…å¼€å‘ä¸­å¯ä»¥ä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€æé«˜ç¨‹åºå®‰å…¨æ€§ã€èŠ‚çœå†…å­˜ç©ºé—´ç­‰ï¼Œå› æ­¤å¼€å‘äººå‘˜éœ€è¦æ·±å…¥ç†è§£å†…å­˜å¯¹é½çš„åŸç†å’Œè§„åˆ™ï¼Œå¹¶æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œåˆç†çš„å†…å­˜å¯¹é½</p><h2 id="å†…å­˜å¯¹é½ä¸ä½åŸŸ"><a href="#å†…å­˜å¯¹é½ä¸ä½åŸŸ" class="headerlink" title="å†…å­˜å¯¹é½ä¸ä½åŸŸ"></a>å†…å­˜å¯¹é½ä¸ä½åŸŸ</h2><p>ä½åŸŸæ˜¯ä¸€ç§æ§åˆ¶å†…å­˜äºŒè¿›åˆ¶ä½çš„æŠ€æœ¯</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  <span class="token keyword">uint16_t</span> a <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">uint16_t</span> b <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token keyword">uint16_t</span> c <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// sizeof(A) == 2;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä¸Šä¾¿å¯æŒ‡å®šaå ç”¨1bitï¼ˆbitä¸æ˜¯byteï¼ï¼‰ï¼Œb 5bitï¼Œc 3 bit</p><p>ä½åŸŸçš„å¯¹é½è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li><p>å½“ç›¸é‚»ä½åŸŸæˆå‘˜çš„ç±»å‹ç›¸åŒæ—¶ï¼Œå¦‚æœå®ƒä»¬çš„ä½å®½ä¹‹å’Œå°äºç±»å‹å¤§å°ï¼Œé‚£ä¹ˆåé¢çš„æˆå‘˜ç´§é‚»å‰ä¸€ä¸ªæˆå‘˜å­˜å‚¨ï¼›å¦‚æœå®ƒä»¬çš„ä½å®½ä¹‹å’Œå¤§äºç±»å‹å¤§å°ï¼Œé‚£ä¹ˆåé¢çš„æˆå‘˜å°†å­˜åœ¨ä¸‹ä¸€ä¸ªç±»å‹å¤§å°çš„ç©ºé—´</p></li><li><p>å¦‚æœç›¸é‚»çš„ä½åŸŸçš„æ•°æ®ç±»å‹ä¸ç›¸åŒï¼Œåˆ™ä¸åŒç¼–è¯‘å™¨å®ç°ä¸ä¸€æ ·ï¼Œæœ‰äº›ç¼–è¯‘å™¨é€‰æ‹©ä¸å‹ç¼©</p></li><li><p>å¦‚æœä½åŸŸä¸è¿ç»­ï¼Œä¸­é—´å«éä½åŸŸï¼Œåˆ™æŒ‰æ ‡å‡†æ•°æ®ç±»å‹å¤§å°åˆ’åˆ†ï¼Œæ¯”å¦‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">A</span><span class="token punctuation">{</span>ã€€ã€€<span class="token keyword">uint16_t</span> a <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>ã€€ã€€<span class="token keyword">int</span> b<span class="token punctuation">;</span>ã€€ã€€<span class="token keyword">uint16_t</span> c <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// sizeof(A) == 12;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>å¯¹äºç¬¬ä¸€ä¸ªä½åŸŸå¯¹é½è§„åˆ™å†ä¸¾ä¸ªä¾‹å­</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bitset&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>  <span class="token keyword">uint16_t</span> a <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">uint16_t</span> b <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token keyword">uint16_t</span> c <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">union</span> <span class="token punctuation">{</span>  A a<span class="token punctuation">;</span>  <span class="token keyword">uint16_t</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span> op<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  op<span class="token punctuation">.</span>a<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  op<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  op<span class="token punctuation">.</span>a<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// è¾“å‡º b çš„äºŒè¿›åˆ¶è¡¨ç¤º</span>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">bitset</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">16</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>  <span class="token comment">// 0000000001000011</span>  op<span class="token punctuation">.</span>a<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">bitset</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">16</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>  <span class="token comment">// 0000000001000010</span>  op<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">bitset</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">16</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>  <span class="token comment">// 0000000001000000</span>  op<span class="token punctuation">.</span>a<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">bitset</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">16</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span><span class="token punctuation">;</span>  <span class="token comment">// 0000000000000000</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="C-11-alignasè¯´æ˜ç¬¦"><a href="#C-11-alignasè¯´æ˜ç¬¦" class="headerlink" title="C++11 alignasè¯´æ˜ç¬¦"></a>C++11 alignasè¯´æ˜ç¬¦</h2><p>è¯¥è¯´æ˜ç¬¦å¯ä»¥æ¥å—ç±»å‹æˆ–è€…å¸¸é‡è¡¨è¾¾å¼ã€‚ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å¸¸é‡è¡¨è¾¾å¼è®¡ç®—çš„ç»“æœå¿…é¡»æ˜¯ä¸€ä¸ª2çš„å¹‚å€¼ï¼Œå¦åˆ™æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ã€‚å…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼ˆè¿™é‡Œé‡‡ç”¨GCC ç¼–è¯‘å™¨ï¼Œå› ä¸ºå…¶alignofå¯ä»¥æŸ¥çœ‹å˜é‡çš„å¯¹é½å­—èŠ‚é•¿åº¦ï¼‰</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token keyword">struct</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>  <span class="token keyword">char</span> a1<span class="token punctuation">;</span>  <span class="token keyword">int</span> a2<span class="token punctuation">;</span>  <span class="token keyword">double</span> a3<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">X1</span> <span class="token punctuation">{</span>  <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">char</span> a1<span class="token punctuation">;</span>  <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token keyword">int</span> a2<span class="token punctuation">;</span>  <span class="token keyword">double</span> a3<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> X2 <span class="token punctuation">{</span>  <span class="token keyword">char</span> a1<span class="token punctuation">;</span>  <span class="token keyword">int</span> a2<span class="token punctuation">;</span>  <span class="token keyword">double</span> a3<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> X3 <span class="token punctuation">{</span>  <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">char</span> a1<span class="token punctuation">;</span>  <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token keyword">int</span> a2<span class="token punctuation">;</span>  <span class="token keyword">double</span> a3<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">COUT_ALIGN</span><span class="token expression"><span class="token punctuation">(</span>s<span class="token punctuation">)</span>                                                          </span><span class="token punctuation">\</span>  <span class="token expression">std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"alignof("</span> <span class="token expression"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">s</span> </span></span><span class="token string">") = "</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> <span class="token keyword">alignof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">COUT_SIZE</span><span class="token expression"><span class="token punctuation">(</span>s<span class="token punctuation">)</span>                                                          </span><span class="token punctuation">\</span>  <span class="token expression">std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> </span><span class="token string">"sizeof("</span> <span class="token expression"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">s</span> </span></span><span class="token string">") = "</span> <span class="token expression"><span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  X x<span class="token punctuation">;</span>  X1 x1<span class="token punctuation">;</span>  X2 x2<span class="token punctuation">;</span>  X3 x3<span class="token punctuation">;</span>  <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> X3 x4<span class="token punctuation">;</span>  <span class="token function">COUT_ALIGN</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 8</span>  <span class="token function">COUT_ALIGN</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 16</span>  <span class="token function">COUT_ALIGN</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 16</span>  <span class="token function">COUT_ALIGN</span><span class="token punctuation">(</span>x3<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 16</span>  <span class="token function">COUT_ALIGN</span><span class="token punctuation">(</span>x4<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 4</span>  <span class="token function">COUT_ALIGN</span><span class="token punctuation">(</span>x4<span class="token punctuation">.</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 8</span>  <span class="token function">COUT_SIZE</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 16</span>  <span class="token function">COUT_SIZE</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 32</span>  <span class="token function">COUT_SIZE</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 16</span>  <span class="token function">COUT_SIZE</span><span class="token punctuation">(</span>x3<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 32</span>  <span class="token function">COUT_SIZE</span><span class="token punctuation">(</span>x4<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 32</span>  <span class="token function">COUT_SIZE</span><span class="token punctuation">(</span>x4<span class="token punctuation">.</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¾‹å­ä¸­ï¼ŒXçš„ç±»å‹å¯¹é½å­—èŠ‚é•¿åº¦ä¸º8å­—èŠ‚ï¼Œè€ŒX2åœ¨ä½¿ç”¨äº†alignas(16)ä¹‹åï¼Œå¯¹é½å­—èŠ‚é•¿åº¦ä¿®æ”¹ä¸ºäº†16å­—èŠ‚ã€‚<br>å¦å¤–ï¼Œ å¦‚æœä¿®æ”¹ç»“æ„ä½“æˆå‘˜çš„å¯¹é½å­—èŠ‚é•¿åº¦ï¼Œé‚£ä¹ˆç»“æ„ä½“æœ¬èº«çš„å¯¹é½å­—èŠ‚é•¿åº¦ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºç»“æ„ä½“ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦æ€»æ˜¯éœ€è¦å¤§äºæˆ–è€…ç­‰äºå…¶æˆå‘˜å˜é‡ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦ã€‚<br>æ¯”å¦‚X1çš„æˆå‘˜å˜é‡a1ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦ä¿®æ”¹ä¸ºäº†16å­—èŠ‚ï¼Œæ‰€æœ‰X1ç±»å‹ä¹Ÿè¢«ä¿®æ”¹ä¸º16å­—èŠ‚å¯¹é½ã€‚<br>åŒæ ·çš„è§„åˆ™ä¹Ÿé€‚ç”¨äºç»“æ„ä½“X3ï¼ŒX3ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦è¢«æŒ‡å®šä¸º16å­—èŠ‚ï¼Œè™½ç„¶å…¶æˆå‘˜å˜é‡a1çš„ç±»å‹å¯¹é½å­—èŠ‚é•¿åº¦è¢«æŒ‡å®šä¸º8å­—èŠ‚ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ”¹å˜X3ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦ã€‚<br>æœ€åè¦è¯´æ˜çš„æ˜¯ï¼Œç»“æ„ä½“ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦ï¼Œå¹¶ä¸èƒ½å½±å“å£°æ˜å˜é‡æ—¶å˜é‡çš„å¯¹é½å­—èŠ‚é•¿åº¦ï¼Œæ¯”å¦‚x4ã€‚<br>ä¸è¿‡åœ¨å˜é‡å£°æ˜æ—¶æŒ‡å®šå¯¹é½å­—èŠ‚é•¿åº¦ï¼Œä¹Ÿä¸å½±å“å˜é‡å†…éƒ¨æˆå‘˜å˜é‡ç±»å‹çš„å¯¹é½å­—èŠ‚é•¿åº¦ï¼Œæ¯”å¦‚x4.a1ã€‚ä¸Šé¢çš„ä»£ç ç”¨ç»“æ„ä½“ä½œä¸ºä¾‹å­ï¼Œå®é™…ä¸Šå¯¹äºç±»ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p><p>å‚è€ƒï¼š<br>chatGPT</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­è¨€é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxç³»ç»Ÿç¼–ç¨‹å…¥é—¨</title>
      <link href="/linux-xi-tong-bian-cheng-ru-men/"/>
      <url>/linux-xi-tong-bian-cheng-ru-men/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€æ˜“ç¯å¢ƒæ­å»º"><a href="#ç®€æ˜“ç¯å¢ƒæ­å»º" class="headerlink" title="ç®€æ˜“ç¯å¢ƒæ­å»º"></a>ç®€æ˜“ç¯å¢ƒæ­å»º</h2><p>æœ¬åœ°</p><ul><li>ä¸‹è½½ vmware</li><li>ä»å®˜ç½‘ä¸‹è½½ 20.04LTS é•œåƒï¼ˆé•¿æœŸç»´æŠ¤ç‰ˆï¼‰ï¼Œå®‰è£…è™šæ‹Ÿæœºï¼Œ100Gç©ºé—´ï¼Œ4Gå†…å­˜ï¼Œ2æ ¸ï¼ˆæœ¬åœ° win11ï¼Œ1Tï¼Œ16Gï¼Œ4æ ¸ï¼‰</li><li>ä¸‹è½½ sshï¼Œå¤åˆ¶ id_rsa.pub å…¬é’¥æ–‡ä»¶</li></ul><p>è™šæ‹Ÿæœº</p><ul><li>å®‰è£… gccï¼Œg++ï¼Œsshï¼Œgdbï¼Œmakeï¼Œ<code>sudo apt install gcc g++ ssh gdb make</code></li><li>åˆ›å»º ssh å…¬ç§é’¥ï¼Œ<code>ssh-keygen</code></li><li>å¤åˆ¶ä¹‹å‰çš„å…¬é’¥åˆ° authorized_keysæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰åˆ™åˆ›å»ºè¯¥æ–‡ä»¶</li><li>ifconfig æŸ¥çœ‹ ip åœ°å€</li></ul><p>æœ¬åœ°</p><ul><li>ä¸‹è½½vscodeï¼Œåœ¨remoteç®¡ç†è®¾ç½®é‡Œï¼Œä»¥ä¹‹å‰ ip åœ°å€åˆ›å»ºè¿œç¨‹è¿æ¥</li><li>ç™»å½•è™šæ‹Ÿæœº</li><li>ä¸‹è½½ C++ å…¨å®¶æ¡¶æ’ä»¶ï¼Œä¸­æ–‡æ’ä»¶ï¼Œæ–‡ä»¶æ˜¾ç¤ºç¾åŒ–æ’ä»¶</li></ul><h2 id="GCC"><a href="#GCC" class="headerlink" title="GCC"></a>GCC</h2><p>ç¼–è¯‘ C æ–‡ä»¶ï¼Œå°½é‡ä½¿ç”¨ gcc å‘½ä»¤ï¼Œç¼–è¯‘ C++ æ–‡ä»¶ï¼Œå°½é‡ä½¿ç”¨ g++</p><p>gcc ä¸èƒ½è‡ªåŠ¨å’Œ C++ ä½¿ç”¨çš„åº“é“¾æ¥ï¼Œg++ ç»Ÿä¸€å½“ä½œ C++ ç¼–è¯‘ï¼Œè¯­æ³•æ£€æŸ¥æ›´ä¸¥ï¼Œæ•…å°½é‡ç”¨å¯¹åº”å‘½ä»¤ç¼–è¯‘</p><table><thead><tr><th>gccç¼–è¯‘é€‰é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-E</td><td>é¢„å¤„ç†æŒ‡å®šçš„æºæ–‡ä»¶ï¼Œä¸è¿›è¡Œç¼–è¯‘</td></tr><tr><td>-S</td><td>ç¼–è¯‘æŒ‡å®šçš„æºæ–‡ä»¶,ä½†æ˜¯ä¸è¿›è¡Œæ±‡ç¼–</td></tr><tr><td>-c</td><td>ç¼–è¯‘ã€æ±‡ç¼–æŒ‡å®šçš„æºæ–‡ä»¶ï¼Œä½†æ˜¯ä¸è¿›è¡Œé“¾æ¥</td></tr><tr><td>-o</td><td>-o file1 file2 æˆ– file2 -o file1 å°†æ–‡ä»¶ file2 ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ file1</td></tr><tr><td>-I</td><td>æŒ‡å®šincludeåŒ…å«æ–‡ä»¶çš„æœç´¢ç›®å½•</td></tr><tr><td>-g</td><td>åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼Œè¯¥ç¨‹åºå¯ä»¥è¢«è°ƒè¯•å™¨è°ƒè¯•</td></tr><tr><td>-D</td><td>åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™ï¼ŒæŒ‡å®šä¸€ä¸ªå®</td></tr><tr><td>-w</td><td>ä¸ç”Ÿæˆä»»ä½•è­¦å‘Šä¿¡æ¯</td></tr><tr><td>-Wall</td><td>ç”Ÿæˆæ‰€æœ‰è­¦å‘Šä¿¡æ¯</td></tr><tr><td>-On</td><td>nçš„å–å€¼èŒƒå›´:0~3ã€‚ç¼–è¯‘å™¨çš„ä¼˜åŒ–é€‰é¡¹çš„4ä¸ªçº§åˆ«,-o0è¡¨ç¤ºæ²¡æœ‰ä¼˜åŒ–ï¼Œ-o1ä¸ºç¼ºçœå€¼ï¼Œ-o3ä¼˜åŒ–çº§åˆ«æœ€é«˜</td></tr><tr><td>-l</td><td>åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™ï¼ŒæŒ‡å®šä½¿ç”¨çš„åº“</td></tr><tr><td>-L</td><td>æŒ‡å®šç¼–è¯‘çš„æ—¶å€™ï¼Œæœç´¢çš„åº“çš„è·¯å¾„</td></tr><tr><td>-fPIC/-fpic</td><td>ç”Ÿæˆä¸ä½ç½®æ— å…³çš„ä»£ç </td></tr><tr><td>-shared</td><td>ç”Ÿæˆå…±äº«ç›®æ ‡æ–‡ä»¶,é€šå¸¸ç”¨åœ¨å»ºç«‹å…±äº«åº“æ—¶</td></tr><tr><td>-std</td><td>æŒ‡å®šcæ–¹è¨€ï¼Œå¦‚:-std=c99,gccé»˜è®¤çš„æ–¹è¨€æ˜¯GNU c</td></tr></tbody></table><h2 id="åº“"><a href="#åº“" class="headerlink" title="åº“"></a>åº“</h2><p>é™æ€åº“ï¼šGCC è¿›è¡Œé“¾æ¥æ—¶ï¼Œä¼šæŠŠé™æ€åº“ä¸­ä»£ç æ‰“åŒ…åˆ°å¯æ‰§è¡Œç¨‹åºä¸­</p><p>åŠ¨æ€åº“ï¼šGCC è¿›è¡Œé“¾æ¥æ—¶ï¼ŒåŠ¨æ€åº“çš„ä»£ç ä¸ä¼šè¢«æ‰“åŒ…åˆ°å¯æ‰§è¡Œç¨‹åºä¸­</p><h3 id="é™æ€åº“"><a href="#é™æ€åº“" class="headerlink" title="é™æ€åº“"></a>é™æ€åº“</h3><h4 id="åˆ¶ä½œ"><a href="#åˆ¶ä½œ" class="headerlink" title="åˆ¶ä½œ"></a>åˆ¶ä½œ</h4><p><code>ar rcs libxxx.a ...</code> ä½¿ç”¨ .o æ–‡ä»¶åˆ›å»ºä¸€ä¸ªåä¸ºxxxçš„é™æ€åº“</p><p>r â€”â€” å°†æ–‡ä»¶æ’å…¥å¤‡å­˜æ–‡ä»¶ä¸­<br>c â€”â€” å»ºç«‹å¤‡å­˜æ–‡ä»¶<br>s â€”â€” ç´¢å¼•</p><p>æ‰©å±•ååœ¨ linux ä¸‹æ˜¯ .a ï¼Œwindows ä¸‹ .lib</p><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230123154729.png"></p><p>å¯¹äºè¯¥ç¤ºä¾‹ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ <code>gcc main.c -o app -I ./include/ -l calc -L ./lib</code> æ¥å°†é™æ€åº“ç¼–è¯‘è¿›æ¥</p><p>è¡¨ç¤ºåœ¨ <code>./include</code> ç›®å½•ä¸‹æœå¯»å¤´æ–‡ä»¶ï¼Œé“¾æ¥åä¸º <code>calc</code> çš„åº“ï¼Œåœ¨ <code>./lib</code> ä¸‹æœå¯»åº“</p><h3 id="åŠ¨æ€åº“"><a href="#åŠ¨æ€åº“" class="headerlink" title="åŠ¨æ€åº“"></a>åŠ¨æ€åº“</h3><p>ç¨‹åºå¯åŠ¨ä¹‹åï¼ŒåŠ¨æ€åº“ä¼šè¢«åŠ¨æ€åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œé€šè¿‡ldd (list dynamicdependenciesï¼‰å‘½ä»¤æ£€æŸ¥åŠ¨æ€åº“ä¾èµ–å…³ç³»</p><p><strong>åŠ¨æ€åº“çš„å®šä½</strong>ï¼ˆlinuxç³»ç»Ÿï¼‰ï¼š</p><p>å¯¹äºelfæ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç”± ld-linux.so å®Œæˆé“¾æ¥ï¼Œè·¯å¾„ä¸º</p><p><strong>DT_RPATHæ®µ -&gt; ç¯å¢ƒå˜é‡ LD_LIBRARY_PATH -&gt; /etc/ld.so.cache æ–‡ä»¶åˆ—è¡¨ -&gt; /lib/ï¼Œ/usr/lib</strong></p><p><strong>ç¯å¢ƒå˜é‡</strong>ï¼š</p><p>å…¨å±€åœ¨ <strong>/etc/profile</strong> ä¿®æ”¹ï¼Œç”¨æˆ·åœ¨ <strong>~/.bashrc</strong>ï¼Œç”¨æˆ·ä¸å…¨å±€ç›¸åŒçš„ç¯å¢ƒå˜é‡ä¼šè¦†ç›–</p><p>ä¸€ä¸ªå˜é‡å¯ä»¥å¯¹åº”å¤šä¸ªå€¼ï¼Œå¤šä¸ªå€¼ä»¥ ï¼šéš”å¼€ï¼Œå¯»æ‰¾æ—¶ä¾æ¬¡å¯»æ‰¾</p><p>åˆ›å»ºç¯å¢ƒå˜é‡å¯ç”¨åœ¨ä¸Šè¿°ä¸¤ä¸ªæ–‡ä»¶ä¸­å†™exportå‘½ä»¤ï¼Œå¹¶sourceä½¿ä¹‹ç”Ÿæ•ˆï¼Œæ¯”å¦‚ <code>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:ç»å¯¹è·¯å¾„</code></p><p>ä¸ç”¨exportå®šä¹‰çš„å˜é‡åªå¯¹è¯¥shellæœ‰æ•ˆï¼Œå¯¹å­shellä¹Ÿæ˜¯æ— æ•ˆçš„</p><p>å¦‚æœåªåœ¨æŸä¸ªç»ˆç«¯å†™exportå‘½ä»¤ï¼Œåˆ™ç¯å¢ƒå˜é‡æ˜¯ä¸´æ—¶çš„</p><h4 id="åˆ¶ä½œ-1"><a href="#åˆ¶ä½œ-1" class="headerlink" title="åˆ¶ä½œ"></a>åˆ¶ä½œ</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc -c -fpic/fPIC a.c b.cgcc -shared a.o b.o -o libcalc.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>-fpic/fPIC ç”Ÿæˆä½ç½®æ— å…³çš„æ–‡ä»¶</p><p>-shared ç”Ÿæˆå…±äº«åº“ï¼Œä»¥åŠ¨æ€é“¾æ¥</p><p>å¦‚æœé“¾æ¥çš„å¯æ‰§è¡Œæ–‡ä»¶çš„GOTå¤§å°è¶…è¿‡è®¡ç®—æœºç‰¹å®šçš„æœ€å¤§å¤§å°ï¼Œåˆ™ä¼šä»é“¾æ¥å™¨æ”¶åˆ°é”™è¯¯æ¶ˆæ¯ï¼ŒæŒ‡ç¤º-fpicä¸èµ·ä½œç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·ä½¿ç”¨-fPICé‡æ–°ç¼–è¯‘ã€‚GOTå¤§å°æ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒè€Œå¤§å°ä¸ä¸€æ ·ã€‚å› æ­¤å°½é‡ä½¿ç”¨-fPICç¼–è¯‘</p><p>æ‰©å±•ååœ¨ linux ä¸‹æ˜¯ .a ï¼Œwindows ä¸‹ .dll</p><h4 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p><img src="https://caidd-1305545187.cos.ap-nanjing.myqcloud.com/20230123194629.png"></p><p>ç¤ºä¾‹ï¼š</p><p><code>gcc main.c -o main -I include/ -L lib/ -l calc</code></p><p>è€Œåç”±ä¹‹å‰æ‰€è¯´æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p><p>ç¬¬ä¸€ç§ï¼š</p><p>ç„¶ååœ¨ä¹‹å‰è¯´çš„ä¸¤ä¸ªæ–‡ä»¶å¤¹æ·»åŠ ç¯å¢ƒå˜é‡åœ°å€å³å¯ï¼Œå¹¶ä½¿ç”¨sourceä½¿ä¹‹ç”Ÿæ•ˆ</p><p><code>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/caidd/linux/test/lib</code></p><p>è¯¥å‘½ä»¤è¡¨ç¤ºï¼Œä¿æŒåŸå§‹ç¯å¢ƒå˜é‡çš„å†…å®¹ï¼Œåœ¨å…¶åæ·»åŠ ä¸€ä¸ªå˜é‡ï¼Œå³åº“æ–‡ä»¶å¤¹ä½ç½®</p><p>ç¬¬äºŒç§ï¼š</p><p>ä¿®æ”¹ /etc/ld.so.conf æ–‡ä»¶ï¼Œç›´æ¥å°†ç›®æ ‡åº“çš„æ–‡ä»¶å¤¹ç»å¯¹ä½ç½®å¤åˆ¶åˆ°æœ€åå³å¯</p><p>ç„¶åä½¿ç”¨ sudo ldconfig ä½¿ä¹‹ç”Ÿæ•ˆ</p><p>ç¬¬ä¸‰ç§ï¼š</p><p>å°†åº“æ”¾åˆ° /lib/ï¼Œ/usr/lib é‡Œé¢ï¼Œä¾¿ä¼šè‡ªåŠ¨æ‰¾åˆ°ï¼Œä½†ç”±äºä¼šå¼•èµ·å‘½åå†²çªï¼Œæ‰€ä»¥ä¸æ¨è</p><h3 id="é™æ€åº“ä¸åŠ¨æ€åº“å¯¹æ¯”"><a href="#é™æ€åº“ä¸åŠ¨æ€åº“å¯¹æ¯”" class="headerlink" title="é™æ€åº“ä¸åŠ¨æ€åº“å¯¹æ¯”"></a>é™æ€åº“ä¸åŠ¨æ€åº“å¯¹æ¯”</h3><p>é™æ€åº“ï¼š</p><p>ä¼˜ç‚¹</p><ul><li>é™æ€åº“è¢«æ‰“åŒ…åˆ°åº”ç”¨ç¨‹åºä¸­åŠ è½½é€Ÿåº¦å¿«</li><li>å‘å¸ƒç¨‹åºæ— éœ€æä¾›é™æ€åº“ï¼Œç§»æ¤æ–¹ä¾¿</li></ul><p>ç¼ºç‚¹</p><ul><li>æ¶ˆè€—ç³»ç»Ÿèµ„æº,æµªè´¹å†…å­˜</li><li>æ›´æ–°ã€éƒ¨æš‘ã€å‘å¸ƒéº»çƒ¦</li></ul><p>åŠ¨æ€åº“ï¼š</p><p>ä¼˜ç‚¹</p><ul><li>å¯ä»¥å®ç°è¿›ç¨‹é—´èµ„æºå…±äº«(å…±äº«åº“)æ›´æ–°ã€éƒ¨ç½²ã€å‘å¸ƒç®€å•</li><li>å¯ä»¥æ§åˆ¶ä½•æ—¶åŠ è½½åŠ¨æ€åº“</li></ul><p>ç¼ºç‚¹</p><ul><li>åŠ è½½é€Ÿåº¦æ¯”é™æ€åº“æ…¢</li><li>å‘å¸ƒç¨‹åºæ—¶éœ€è¦æä¾›ä¾èµ–çš„åŠ¨æ€åº“</li></ul><h2 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h2><p><a href="https://seisman.github.io/how-to-write-makefile/index.html">è‡ªå·±å­¦</a>ï¼Œåç»­ä¼šæ¥è§¦åˆ°çš„cmakeï¼Œxmakeï¼Œä¸»è¦ç”¨äºç”Ÿæˆ makefile æ–‡ä»¶ã€‚è¿™äº›ä¸œè¥¿éƒ½æ˜¯ç”¨äºå¤„ç†å¤§å‹é¡¹ç›®çš„ä¾èµ–å…³ç³»ã€‚</p><p>Makefile ä¸ä»…ä½¿å¾—é¡¹ç›®ç¼–è¯‘æ›´ä¸ºè½»æ¾ï¼Œè¿˜èƒ½ä½¿ç¼–è¯‘é€Ÿåº¦æ›´å¿«ï¼Œå…¶ä¼šè‡ªåŠ¨æ¯”å¯¹æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ï¼Œåªæœ‰å½“ç›®æ ‡æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¾èµ–æ–‡ä»¶çš„æ›´æ–°æ—¶é—´æ™šäºç›®æ ‡æ–‡ä»¶æ‰ä¼šè¿›è¡Œæ›´æ–°ã€‚</p><h2 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a>GDB</h2><p>ç”Ÿæˆå¯è°ƒè¯•æ‰§è¡Œç¨‹åºï¼Œgccï¼Œg++ éœ€è¦åŠ ä¸Š -g å‚æ•°ï¼Œæ‰èƒ½åœ¨åŸå§‹ç¨‹åºæ·»åŠ ç¬¦å·è¡¨ï¼Œä½¿å¾— gdb èƒ½å¤Ÿè¿›è¡Œè°ƒè¯•</p><p><strong>å¯åŠ¨å’Œé€€å‡º</strong><br>gdb å¯æ‰§è¡Œç¨‹åºåå­—<br>quit é€€å‡º</p><p><strong>ç»™ç¨‹åºè®¾ç½®å‚æ•°/è·å–è®¾ç½®å‚æ•°</strong></p><p>set args 10 20<br>show args</p><p><strong>GDBä½¿ç”¨å¸®åŠ©</strong></p><p>help</p><p><strong>æŸ¥çœ‹å½“å‰æ–‡ä»¶ä»£ç </strong></p><p>list/l ï¼ˆä»é»˜è®¤ä½ç½®æ˜¾ç¤ºï¼‰</p><p>list/l è¡Œå· ï¼ˆä»¥æŒ‡å®šè¡Œå·ä¸ºä¸­å¿ƒè¿›è¡Œæ˜¾ç¤ºï¼‰</p><p>list/l å‡½æ•°å ï¼ˆä»æŒ‡å®šçš„å‡½æ•°æ˜¾ç¤ºï¼‰</p><p><strong>æŸ¥çœ‹éå½“å‰æ–‡ä»¶ä»£ç </strong></p><p>list/l æ–‡ä»¶å:è¡Œå· </p><p>list/l æ–‡ä»¶å:å‡½æ•°å</p><p><strong>è®¾ç½®ä¸æŸ¥çœ‹æ˜¾ç¤ºçš„è¡Œæ•°</strong></p><p>show list/listsize</p><p>set list/listsize è¡Œæ•°</p><p><strong>è®¾ç½®æ–­ç‚¹</strong></p><p>b/break è¡Œå·</p><p>b/break å‡½æ•°å</p><p>b/break æ–‡ä»¶å:è¡Œå·</p><p>b/break æ–‡ä»¶å:å‡½æ•°</p><p><strong>æŸ¥çœ‹æ–­ç‚¹</strong></p><p>i/info b/break</p><p><strong>åˆ é™¤æ–­ç‚¹</strong></p><p>d/del/delete æ–­ç‚¹ç¼–å·</p><p><strong>è®¾ç½®æ–­ç‚¹æ— æ•ˆ</strong></p><p>dis/disable æ–­ç‚¹ç¼–å·</p><p><strong>è®¾ç½®æ–­ç‚¹ç”Ÿæ•ˆ</strong></p><p>ena/enable æ–­ç‚¹ç¼–å·</p><p><strong>è®¾ç½®æ¡ä»¶æ–­ç‚¹ï¼ˆä¸€èˆ¬ç”¨åœ¨å¾ªç¯çš„ä½ç½®ï¼‰</strong></p><p>b/break 10 if i == 5</p><p><strong>è¿è¡ŒGDBç¨‹åº</strong></p><p>startï¼ˆç¨‹åºåœåœ¨ç¬¬ä¸€è¡Œï¼‰</p><p>runï¼ˆé‡åˆ°æ–­ç‚¹æ‰åœï¼‰</p><p><strong>ç»§ç»­è¿è¡Œï¼Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœ</strong></p><p>c/continue</p><p><strong>å‘ä¸‹æ‰§è¡Œä¸€è¡Œä»£ç ï¼ˆä¸ä¼šè¿›å…¥å‡½æ•°ä½“ï¼‰</strong></p><p>n/next</p><p><strong>å˜é‡æ“ä½œ</strong></p><p>p/print  å˜é‡åï¼ˆæ‰“å°å˜é‡å€¼ï¼‰</p><p>ptype å˜é‡åï¼ˆæ‰“å°å˜é‡ç±»å‹ï¼‰</p><p><strong>å‘ä¸‹å•æ­¥è°ƒè¯•ï¼ˆé‡åˆ°å‡½æ•°è¿›å…¥å‡½æ•°ä½“ï¼‰</strong></p><p>s/step</p><p>finishï¼ˆè·³å‡ºå‡½æ•°ä½“ï¼‰</p><p><strong>è‡ªåŠ¨å˜é‡æ“ä½œ</strong></p><p>display numï¼ˆè‡ªåŠ¨æ‰“å°æŒ‡å®šå˜é‡çš„å€¼ï¼‰</p><p>i/info display</p><p>undisplay ç¼–å·</p><p><strong>å…¶ä»–æ“ä½œ</strong></p><p>set var å˜é‡å = å˜é‡å€¼</p><p>untill ï¼ˆè·³å‡ºå¾ªç¯ï¼Œè·³å‡ºå¾ªç¯çš„æ¡ä»¶æ˜¯å¾ªç¯å†…éƒ¨æ²¡æœ‰æ–­ç‚¹ï¼Œå¹¶ä¸”åœ¨å¾ªç¯è¯­å¥å†…ï¼‰</p><p><strong>å¤šè¿›ç¨‹è°ƒè¯•</strong></p><p>set folllow-fork-mode [parentï¼ˆé»˜è®¤ï¼‰ | child] è®¾ç½®è°ƒè¯•çˆ¶è¿›ç¨‹æˆ–è€…å­è¿›ç¨‹</p><p>set detach-on-fork [on l off] è®¾ç½®è°ƒè¯•æ¨¡å¼</p><p>é»˜è®¤ä¸ºonï¼Œè¡¨ç¤ºè°ƒè¯•å½“å‰è¿›ç¨‹çš„æ—¶å€™ï¼Œå…¶å®ƒçš„è¿›ç¨‹ç»§ç»­è¿è¡Œï¼Œå¦‚æœä¸º offï¼Œè°ƒè¯•å½“å‰è¿›ç¨‹çš„æ—¶å€™ï¼å…¶å®ƒè¿›ç¨‹è¢«GDBæŒ‚èµ·ã€‚</p><p>info inferiors æŸ¥çœ‹è°ƒè¯•çš„è¿›ç¨‹</p><p>inferior id åˆ‡æ¢å½“å‰è°ƒè¯•çš„è¿›ç¨‹</p><p>detach inferiors id ä½¿è¿›ç¨‹è„±ç¦»GDBè°ƒè¯•</p><p><strong>Core dump åˆ†æ</strong><br><a href="https://www.cnblogs.com/bodhitree/p/5850212.html">gdb coreæ¨¡å¼</a></p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++æµ®ç‚¹æ•°é—®é¢˜</title>
      <link href="/cpp-fu-dian-shu-wen-ti/"/>
      <url>/cpp-fu-dian-shu-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ä¸‹åˆé‡åˆ°è¿™æ ·<a href="https://codeforces.com/contest/1737/problem/B">ä¸€é“é¢˜</a>ï¼Œè¢«å¡äº†ç²¾åº¦ï¼Œè”æƒ³èµ·ä»¥å‰æ¯”èµ›æ—¶è¢«å¡ç²¾åº¦çš„é¢˜ï¼Œä»¥åŠè®¡ç®—è®¡ç»„æˆåŸç†çš„IEEEæµ®ç‚¹æ•°æ ‡å‡†ã€‚æ•…åœ¨æ­¤è¿›è¡Œæ€»ç»“</p><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><p><img src="https://raw.githubusercontent.com/caiddd/picture/main/32-64.jpg"></p><p>åœ¨ä¸åŒçš„è®¡ç®—æœºï¼Œä¸åŒçš„ç¼–è¯‘å™¨ä¸­ï¼Œå¸¸ç”¨çš„ <code>int</code>, <code>double</code>, <code>long long</code> ç±»å‹å­˜å‚¨å¤§å°åŸºæœ¬ä¸å˜ï¼Œä½†æ˜¯ <code>long double</code> å˜åŒ–å´å¾ˆå¤šï¼Œå¯ååè¿™ç§æ•°æ®ç±»å‹åœ¨å¡ç²¾åº¦æ—¶åˆå¾ˆå¸¸ç”¨ï¼Œæ‰€ä»¥æœ‰å¿…è¦å¥½å¥½åˆ†æä¸€ä¸‹ã€‚</p><p>åœ¨Cçš„æ ‡å‡†ä¸­ï¼Œä»…è§„å®š <code>long double</code> çš„ç²¾åº¦èŒƒå›´å¤§äºç­‰äº <code>double</code></p><p>åœ¨ msvcï¼ˆå³VSä½¿ç”¨çš„ç¼–è¯‘å™¨ï¼‰ä¸­ï¼Œ <code>long double</code> ç­‰åŒäº <code>double</code> ï¼Œéƒ½æ˜¯8ä¸ªå­—èŠ‚</p><blockquote><p>  The<code>long double</code> type is identical to the double type.</p></blockquote><p>è€Œåœ¨ gcc ä¸­ä¸¤è€…æ˜¯ä¸åŒçš„</p><p>32ä½ä¸‹<code>long double</code> æ˜¯12ä¸ªå­—èŠ‚, 64ä½ä¸‹æ˜¯16ä¸ªå­—èŠ‚.</p><p><img src="https://raw.githubusercontent.com/caiddd/picture/main/20221008150707.png"></p><p>ç°ä»Šç«èµ›ç¯å¢ƒå¤šä¸º64ä½æœº G++/GCCï¼Œå³ <code>long double</code> å ç”¨äº†16ä¸ªå­—èŠ‚ï¼Œ128ä½ã€‚</p><p>ç„¶è€Œå®é™…ç¼–è¯‘æ—¶ï¼Œç”±äºx86æ¶æ„ä¸Š fpu çš„å­˜åœ¨ï¼Œå¤§éƒ¨åˆ†ç¼–è¯‘å™¨å°† <code>long double</code> ç¼–è¯‘æˆ80ä½çš„æµ®ç‚¹æ•°ï¼Œç”¨ç§‘å­¦è®¡æ•°æ³•çš„è¯ï¼Œå…¶å°¾æ•°éƒ¨åˆ†æ˜¯64ä½ã€‚å‰©ä¸‹çš„éƒ¨åˆ†ä¸»è¦ç”¨äºå†…å­˜å¯¹é½ï¼Œé˜²æ­¢å­˜å–çš„éº»çƒ¦ä»¥åŠå†…å­˜ç©ºé—´ç¢ç‰‡åŒ–ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå°¾æ•°éƒ¨åˆ†åˆšå¥½å­˜å¾—ä¸‹ä¸€ä¸ª <code>long long</code> ï¼Œä¸ä¼šæŸå¤±ç²¾åº¦ã€‚</p><p>ç„¶è€Œï¼Œ<code>double</code> å°¾æ•°éƒ¨åˆ†å°±æ²¡æœ‰é‚£ä¹ˆå¤§äº†</p><p><img src="https://raw.githubusercontent.com/caiddd/picture/main/20221008152931.png"></p><p>æ‰€ä»¥ <code>long long</code> åœ¨è½¬ä¸º <code>double</code> æ—¶ä¼šæŸå¤±ä¸å°‘ç²¾åº¦</p><h2 id="åº“å‡½æ•°"><a href="#åº“å‡½æ•°" class="headerlink" title="åº“å‡½æ•°"></a>åº“å‡½æ•°</h2><p>æƒ³èµ·ä»¥å‰å¾ˆå¤šæ—¶å€™ï¼Œè§‰å¾—ä¸€ä¸ªåº“å‡½æ•°å¥½ç”¨å°±å¤©å¤©æ‹¿æ¥ç©ï¼Œå´æ²¡æœ‰å»æƒ³å…¶åŠŸèƒ½ä¸ä½¿ç”¨èŒƒå›´ã€‚å¯¼è‡´åŸ‹ä¸‹äº†ä¸å°‘å‘ã€‚</p><h3 id="sqrt"><a href="#sqrt" class="headerlink" title="sqrt"></a>sqrt</h3><p>å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæœ€æ˜“å‡ºé—®é¢˜çš„å½“æ•° <code>sqrt</code> å‡½æ•°</p><p>å¾ˆå¤šäººéƒ½çŸ¥é“è¿™ä¸ªå‡½æ•°æ˜¯æ±‚ä¸€ä¸ªæ•°çš„æ ¹ï¼Œä½†æ˜¯å´æ²¡æœ‰å»çœ‹å…¶è¿”å›ç±»å‹ä»¥åŠä¼ å…¥ç±»å‹</p><p>æŸ¥çœ‹cmathåº“çš„å®šä¹‰æºç </p><p><img src="https://raw.githubusercontent.com/caiddd/picture/main/20221008154023.png"></p><p>å¯è§é™¤ <code>float</code>ï¼Œ<code>long double</code>ç±»å‹å¤–ï¼Œå…¶ä½™å‡è¿”å› <code>double</code></p><p>å…¶ä¸­</p><p><img src="https://raw.githubusercontent.com/caiddd/picture/main/20221008155005.png"></p><p><code>float</code> å¦è°ƒç”¨ <code>math.h</code> çš„ <code>sqrtf</code> å‡½æ•°</p><p><code>long double</code> å¦è°ƒç”¨ <code>math.h</code> çš„ <code>sqrtl</code> å‡½æ•°</p><p>å…¶ä»–ç±»å‹åˆ™è°ƒç”¨ <code>math.h</code> çš„ <code>sqrt</code> å‡½æ•°</p><p>è¯¥å‡½æ•°åœ¨Cåº“ä»…æœ‰å¦‚ä¸‹å£°æ˜</p><p><img src="https://raw.githubusercontent.com/caiddd/picture/main/20221008155245.png"></p><p>æ•…æ•´å‹å‡ä¼šå¼ºè½¬ä¸º <code>double</code> è¿›è¡Œè¿ç®—ï¼Œ<code>long long</code> ä¾¿æ˜¯åœ¨æ­¤å¤„ä¼ å…¥æ—¶æŸå¤±äº†ç²¾åº¦ã€‚è‹¥æƒ³ä¸æŸå¤±ç²¾åº¦ï¼Œè¦ä¹ˆä¼ å…¥çš„æ—¶å€™å¼ºè½¬ä¸º<code>long double</code> ï¼Œè¦ä¹ˆè°ƒç”¨Cåº“çš„ <code>sqrtl</code> å‡½æ•°ã€‚</p><h3 id="å…¶ä»–å‡½æ•°"><a href="#å…¶ä»–å‡½æ•°" class="headerlink" title="å…¶ä»–å‡½æ•°"></a>å…¶ä»–å‡½æ•°</h3><p>åç»­åˆå¯¹è®¸å¤šæ•°å­¦åº“å‡½æ•°è¿›è¡Œäº†è§‚å¯Ÿï¼Œå‘ç°å¾ˆå¤šåº“å‡½æ•°éƒ½å¯¹ <code>float</code> ,<code>long double</code> è¿›è¡Œäº†å•ç‹¬å¤„ç†ï¼Œå¯¹äº <code>float</code> å‡½æ•°ååŸºæœ¬éƒ½ä¸ºå¸¸è§çš„é‚£ä¸ªåé¢åŠ ä¸ª<code>f</code>ï¼Œå¯¹äº <code>float</code> å‡½æ•°ååŸºæœ¬éƒ½ä¸ºå¸¸è§çš„é‚£ä¸ªåé¢åŠ ä¸ª<code>l</code>ã€‚æ•°å­¦åº“çš„å‡½æ•°å¤§éƒ¨åˆ†éƒ½æ˜¯è¿”å› <code>double</code> å‹ï¼Œè€Œéæ•´å‹ã€‚åˆå­¦è€…å¾€å¾€ä¼šå°† <code>pow</code>ï¼Œ<code>ceil</code> è¯¯å½“ä½œè¿”å›æ•´å‹çš„å‡½æ•°ï¼Œä¸€å®šè¦æ³¨æ„ç²¾åº¦çš„æŸå¤±ã€‚</p><p>é¡ºå¸¦ä¸€æï¼Œè¿™äº›æ•°å­¦åº“å‡½æ•°çš„å¤æ‚åº¦åŸºæœ¬éƒ½æ˜¯å¯ä»¥å½“ä½œ $O(1)$ çš„ï¼Œåªæ˜¯å¸¸æ•°æ¯”è¾ƒå¤§ï¼Œå…¶åº•å±‚æœ‰ç”¨åˆ°ç±»ä¼¼ç‰›é¡¿è¿­ä»£æ³•ä¸€ç±»çš„æ•°å­¦åŠ é€Ÿæ–¹æ³•ã€‚</p><h2 id="ç®—æ³•ä¸Šé¿å…ç²¾åº¦è¯¯å·®"><a href="#ç®—æ³•ä¸Šé¿å…ç²¾åº¦è¯¯å·®" class="headerlink" title="ç®—æ³•ä¸Šé¿å…ç²¾åº¦è¯¯å·®"></a>ç®—æ³•ä¸Šé¿å…ç²¾åº¦è¯¯å·®</h2><p>é¿å…é™¤æ³•å–æ ¹å·ç­‰è¿ç®—ï¼Œä¸ä»…å¯ä»¥åœ¨ç²¾åº¦ä¸Šæå‡ï¼Œè¿˜å¯ä»¥æå¿«é€Ÿåº¦ã€‚æˆ‘æ›¾ç»å°±æœ‰å› ä¸ºé™¤æ³•è€Œåœ¨ä¸€é“é¢˜ä¸Šè¶…æ—¶ã€‚</p><p>æ›¿æ¢æ–¹æ³•ä¸¾ä¾‹ï¼š</p><p>å¦‚å°†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ›¿æ¢ä¸º</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">*</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">p2</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">double</span> <span class="token function">dis</span><span class="token punctuation">(</span><span class="token keyword">int</span> ax<span class="token punctuation">,</span> <span class="token keyword">int</span> ay<span class="token punctuation">,</span> <span class="token keyword">int</span> bx<span class="token punctuation">,</span> <span class="token keyword">int</span> by<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">p2</span><span class="token punctuation">(</span>ax <span class="token operator">-</span> ay<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">p2</span><span class="token punctuation">(</span>bx <span class="token operator">-</span> by<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ›¿æ¢ä¸º</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">dis</span><span class="token punctuation">(</span><span class="token keyword">int</span> ax<span class="token punctuation">,</span> <span class="token keyword">int</span> ay<span class="token punctuation">,</span> <span class="token keyword">int</span> bx<span class="token punctuation">,</span> <span class="token keyword">int</span> by<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">p2</span><span class="token punctuation">(</span>ax <span class="token operator">-</span> ay<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">p2</span><span class="token punctuation">(</span>bx <span class="token operator">-</span> by<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¹¶ç›´æ¥ä½¿ç”¨æ•´æ•°æ¯”è¾ƒè·ç¦»è¿œè¿‘ï¼Œåªåœ¨ç»“æœè¾“å‡ºæ—¶å¯¹å…¶è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­è¨€é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++å¸¸æ•°ä¼˜åŒ–æŠ€å·§</title>
      <link href="/cpp-chang-shu-you-hua-ji-qiao/"/>
      <url>/cpp-chang-shu-you-hua-ji-qiao/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹é¢è¿™ä¸‰è¡Œä»£ç åŠ åˆ°C++çš„å¼€å¤´ï¼Œæœ‰äº›æƒ…å†µå¯ä»¥å¯¹ä»£ç è¿è¡Œé€Ÿåº¦æœ‰æ˜¾è‘—çš„æå‡<br>ä¸€èˆ¬æ¥è¯´ï¼Œä»£ç ç»“æ„è¶Šç®€å•ï¼Œè¿™ä¸‰è¡Œä»£ç ä¼˜åŒ–å¾—è¶Šå¤š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">GCC <span class="token function">target</span> <span class="token punctuation">(</span></span><span class="token string">"avx2"</span><span class="token expression"><span class="token punctuation">)</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">GCC <span class="token function">optimization</span> <span class="token punctuation">(</span></span><span class="token string">"O3"</span><span class="token expression"><span class="token punctuation">)</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">GCC <span class="token function">optimization</span> <span class="token punctuation">(</span></span><span class="token string">"unroll-loops"</span><span class="token expression"><span class="token punctuation">)</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­è¨€é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–™ç†åˆ¶ä½œ</title>
      <link href="/liao-li-zhi-zuo/"/>
      <url>/liao-li-zhi-zuo/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡æŒç»­æ›´æ–°ï¼Œå†…å®¹ä¸»è¦æ˜¯å•äººæ–™ç†ï¼Œé‡ä¹ŸåŸºæœ¬éƒ½æŒ‰ä¸€ä¸ªäººæ¥</p><h2 id="åŸºæœ¬åˆ€æ³•"><a href="#åŸºæœ¬åˆ€æ³•" class="headerlink" title="åŸºæœ¬åˆ€æ³•"></a>åŸºæœ¬åˆ€æ³•</h2><ol><li>è¿ç»­å¿«åˆ€çºµåˆ‡ï¼Œä¸»è¦æ˜¯è”¬èœç±»</li><li>æ…¢åˆ€æ–œåˆ‡ï¼Œä¸€å®šè¦åšåº¦å‡åŒ€ï¼Œåˆ€ä¸ç §æ¿æˆ70åº¦å·¦å³å³å¯ï¼Œä¸è¦å¤ªæ–œã€‚è¯¥æ³•ä¸»è¦ä¸ºå¢å¤§æ¥è§¦é¢ç§¯ï¼Œé’ˆå¯¹è‚‰ç±»</li><li>åŒåˆ€æš´åˆ‡ï¼Œåšè‚‰æœ«ï¼Œè’œè“‰ç­‰</li><li>å¯¹è§’çº¿åˆ‡åŠ çºµåˆ‡ï¼Œä¸»è¦é’ˆå¯¹æ–¹å—ç±»é£Ÿæï¼Œå¦‚æ°´è±†è…å—ã€‚æ–¹æ³•æ˜¯å…ˆæ²¿æ–¹å—å¯¹è§’çº¿åˆ‡ä¸¤åˆ€ï¼Œåˆ†æˆå››ä¸ªç­‰è…°ä¸‰è§’å½¢æŸ±ä½“ã€‚å†æŠŠå››ä¸ªæŸ±ä½“æ²¿é«˜çºµåˆ‡ï¼Œå³å¯å¾—åˆ°è®¸å¤šä¸‰è§’å½¢çš„æ‰è±†è…ï¼Œå½¢çŠ¶å¥½çœ‹ä¹Ÿå…¥å‘³ã€‚</li><li>èŠ±åˆ‡ï¼Œå¯¹äºé£Ÿæè¿ç»­åˆ‡äº†å¾ˆå¤šåˆ€ï¼Œä½†æ˜¯æ¯åˆ€éƒ½æ²¡åˆ°åº•ï¼Œåˆ‡å®Œè¿˜æ˜¯ä¸€ä¸ªæ•´ä½“ã€‚å¦‚æœæ˜¯è±†è…ï¼Œè¿™æ ·åˆ‡å¥½åæ”¾æ°´é‡Œå¯ä»¥å˜æˆä¸€æœµèŠ±ï¼Œä½†æ˜¯ä¸ä¼šæ•£ã€‚ç­‰ä»¥åä¸€å®šå­¦ä¼šã€‚</li></ol><h2 id="çƒ¹é¥ªæ–¹å¼"><a href="#çƒ¹é¥ªæ–¹å¼" class="headerlink" title="çƒ¹é¥ªæ–¹å¼"></a>çƒ¹é¥ªæ–¹å¼</h2><h3 id="ç…®"><a href="#ç…®" class="headerlink" title="ç…®"></a>ç…®</h3><h4 id="é¥ºå­"><a href="#é¥ºå­" class="headerlink" title="é¥ºå­"></a>é¥ºå­</h4><p>é”…å†…åŠ <strong>å†·æ°´</strong>ï¼Œç­‰æ°´çƒ­åä¸‹æ–™ï¼Œåœ¨ä¸‹æ–™ååˆ°æ°´é¥ºæµ®äºæ°´é¢çš„æ—¶é—´é‡Œï¼Œä¸æ–­ç”¨æ¼ç½‘æåº•ï¼Œé˜²æ­¢æ°´é¥ºç²˜é”…ï¼ŒåŠ çƒ­åˆ°æµ®èµ·åä¸ç”¨å†ç®¡</p><p>å†’æ³¡åï¼ŒåŠ ç“¢å†·æ°´ï¼Œç»§ç»­ç…®è‡³å†’æ³¡ï¼Œå†åŠ æ°´ï¼Œå¦‚æ­¤åå¤ï¼Œä¸­é€”éœ€ä½¿æ°´çº¿å§‹ç»ˆé«˜äºé”…åº•ç«ç¢°åˆ°çš„æœ€é«˜çº¿ï¼Œè¿™æ˜¯é˜²æ­¢çƒ§é”…ï¼Œè¿˜è¦é«˜äºæ°´é¥ºçš„é«˜åº¦ï¼Œä½¿å…¶ä¸ç¢°åº•ï¼Œé¿å…ç²˜é”…</p><p>åå¤åŠ æ°´ç›´åˆ°è¯•åƒæ—¶å·²ç»å®Œå…¨ç†Ÿé€</p><p>é¥ºå­ä¸€èˆ¬éœ€è¦åŠ ä¸‰æ¬¡å†·æ°´ï¼Œå¦‚æ­¤æ“ä½œæ˜¯é˜²æ­¢æ²¸è…¾çš„çƒ­æ°´ç…®ç ´é¢çš®ï¼Œä½¿å¾—é‡Œé¢çš„ç²¾åæµå‡ºã€‚ä¸€èˆ¬ç…®ç ´çš„æ°´é¥ºéƒ½ä¸å¤ªå¥½åƒï¼Œå› ä¸ºå‘³é“éƒ½æ•£åˆ°æ°´é‡Œå»äº†</p><h4 id="é¢æ¡ç²‰æ¡"><a href="#é¢æ¡ç²‰æ¡" class="headerlink" title="é¢æ¡ç²‰æ¡"></a>é¢æ¡ç²‰æ¡</h4><p>å’Œé¥ºå­å·®ä¸å¤šï¼Œä¸è¿‡ä¸€èˆ¬åŠ ä¸€æ¬¡å†·æ°´å°±å¥½äº†</p><h3 id="è’¸"><a href="#è’¸" class="headerlink" title="è’¸"></a>è’¸</h3><h4 id="æ²¡æœ‰è’¸é”…"><a href="#æ²¡æœ‰è’¸é”…" class="headerlink" title="æ²¡æœ‰è’¸é”…"></a>æ²¡æœ‰è’¸é”…</h4><p>è¿™æ˜¯å¸¸é‡åˆ°çš„æƒ…å†µï¼Œå¯ä»¥ç”¨ä¸€èˆ¬é”…å­åŠ å°é“æ¶ä»£æ›¿ï¼Œåº•ä¸‹åŠ é€‚é‡æ°´ï¼Œæœ€å¥½æ˜¯ä¿æŒæ°´çº¿åœ¨ç«çº¿ä¹‹ä¸Šï¼Œé˜²çƒ§é”…ï¼Œè¿™ç§æ–¹æ³•ä¸€èˆ¬å°±è’¸ç‚¹å‰©é¥­å‰©èœä¹‹ç±»çš„ï¼Œå¤§æ¦‚åå‡ åˆ†é’Ÿå°±okäº†ã€‚</p><h4 id="æœ‰è’¸é”…"><a href="#æœ‰è’¸é”…" class="headerlink" title="æœ‰è’¸é”…"></a>æœ‰è’¸é”…</h4><p>åŠ æ°´ï¼Œæ”¾å…¶æ¶å­ä¸Šç›´æ¥æ— è„‘è’¸å³å¯</p><p>è’¸è¿™ç§æ–¹å¼æ²¡å¤ªå¤šå¯æ“ä½œæ€§ï¼Œä¸»è¦å°æŠ€å·§åœ¨äºæ§æ°´ï¼Œå°±æ˜¯åœ¨åº•ä¸‹çš„è’¸æ°´é‡Œæ”¾ä¸œè¥¿ï¼Œæ¯”å¦‚ä¸€äº›é¦™æ–™ï¼Œä½¿å…¶é¦™å‘³æ²¿ç€æ°´æ±½é€åˆ°é£Ÿæé‡Œï¼Œæ›´åŠ é¦™ã€‚</p><h3 id="ç‚’"><a href="#ç‚’" class="headerlink" title="ç‚’"></a>ç‚’</h3><h4 id="å¤§ç«çˆ†ç‚’"><a href="#å¤§ç«çˆ†ç‚’" class="headerlink" title="å¤§ç«çˆ†ç‚’"></a>å¤§ç«çˆ†ç‚’</h4><p>æ‰€æœ‰çƒ¹é¥ªæ–¹å¼é‡Œæœ€å…·æŠ€å·§æ€§çš„æ–¹å¼ï¼Œç›®å‰å°±ä¼šæ— è„‘ç¿»ç‚’ï¼Œä¸ç²˜é”…å°±ç®—æˆåŠŸã€‚äº‰å–ä»¥åå­¦ä¼šé¢ é”…ã€‚</p><h4 id="å°ç«æ…¢ç‚’"><a href="#å°ç«æ…¢ç‚’" class="headerlink" title="å°ç«æ…¢ç‚’"></a>å°ç«æ…¢ç‚’</h4><p>æ–°æ‰‹å°±åˆ«å­¦è€æ‰‹æå¤§ç«çˆ†ç‚’äº†ï¼Œæœ€è¿‘å‘ç°è›‹ç‚’é¥­æˆ‘å°ç«æ…¢ç‚’åè€Œå¥½åƒäº›ã€‚</p><h2 id="é¢æ¡æ±¤åº•"><a href="#é¢æ¡æ±¤åº•" class="headerlink" title="é¢æ¡æ±¤åº•"></a>é¢æ¡æ±¤åº•</h2><p>åŸºæœ¬åŸæ–™ï¼šå°è‘±ï¼Œå¤§è’œï¼Œé¦™èœï¼Œå°ç±³è¾£</p><p>åˆ€æ³•1ï¼šè‘±ï¼Œé¦™èœï¼Œå°ç±³è¾£</p><p>æ‹çƒ‚+åˆ€æ³•3ï¼šå¤§è’œ</p><p>å¦‚æœæœ‰æ—¶é—´å¯ä»¥ç”¨æ²¹ç‚¸ä¸€ä¸‹è’œè“‰ï¼Œè¡¨é¢å¾®å¾®å‘é»„å³å¯ï¼Œè¿™æ ·æ›´é¦™ï¼Œç‚¸å®Œçš„æ²¹è¿˜å¯ä»¥å–ä¸€äº›æµ‡åˆ°ä¹‹åçš„æ±¤åº•ä¸Š</p><h3 id="é¦™è¾£æ±¤åº•"><a href="#é¦™è¾£æ±¤åº•" class="headerlink" title="é¦™è¾£æ±¤åº•"></a>é¦™è¾£æ±¤åº•</h3><p>è’œè“‰ + è‘±èŠ± + å°ç±³è¾£ + è¾£æ¤’é¢ï¼ˆæ²¡æœ‰çš„ç”¨è€å¹²å¦ˆä¹Ÿè¡Œï¼‰+ ç™½èŠéº»ï¼ˆæ²¡æœ‰å¯ä»¥ä¸æ”¾ï¼‰+</p><p>ä¹‹å‰çš„è’œæ²¹ + ä¸€å°å‹ºç”ŸæŠ½ + ä¸€å°å‹ºé¦™é†‹ + é€‚é‡ç› + å°‘è®¸ç™½ç³–ï¼ˆå¯ä¸æ”¾ï¼‰</p><p>è¯¥æ±¤åº•è¿˜å¯å½“ä½œé¥ºå­çš„è˜¸æ–™</p><h3 id="éº»æ±æ±¤åº•"><a href="#éº»æ±æ±¤åº•" class="headerlink" title="éº»æ±æ±¤åº•"></a>éº»æ±æ±¤åº•</h3><p>ä¸€å°å‹ºèŠéº»é¦™æ²¹ + ä¸¤å°å‹ºèŠéº»é…± + ä¸¤å°å‹ºç”ŸæŠ½ + ä¸€å°å‹ºé¦™é†‹ + ç™½èŠéº» + æ¦¨èœ + é¦™èœ + è‘±èŠ±</p><h3 id="æ¸…æ±¤æ±¤åº•"><a href="#æ¸…æ±¤æ±¤åº•" class="headerlink" title="æ¸…æ±¤æ±¤åº•"></a>æ¸…æ±¤æ±¤åº•</h3><p>ç› + é¸¡ç²¾ï¼ˆå‡ ç²’å°±è¡Œï¼‰+ å°‘è®¸ç™½ç³– + ä¸€å°å‹ºç”ŸæŠ½ + ä¸€å°å‹ºé¦™é†‹ + èŠéº»é¦™æ²¹ + è‘±èŠ±</p><h2 id="è›‹ç‚’é¥­"><a href="#è›‹ç‚’é¥­" class="headerlink" title="è›‹ç‚’é¥­"></a>è›‹ç‚’é¥­</h2><p>åŸæ–™ï¼šé¸¡è›‹ï¼Œéš”å¤œé¥­ï¼ˆé¢—ç²’æ„Ÿå¼ºï¼‰ï¼Œè€å¹²å¦ˆï¼Œè‘±èŠ±</p><p>æ³¨ï¼šæŠ€æœ¯ä¸è¡Œå»ºè®®ç”¨å°ç«æ…¢ç‚’</p><ul><li>å°†é¸¡è›‹æ‰“æ•£ï¼Œä¸€èˆ¬ä¸¤ä¸ªå°±å¤Ÿäº†</li><li>æ¤ç‰©æ²¹æ¶¦é”…ï¼ŒçŒªæ²¹æˆ–è€…è€å¹²å¦ˆè¾£æ²¹ä¸‹é”…</li><li>æ²¹çƒ­åæ”¾æ‰“æ•£çš„é¸¡è›‹ï¼Œæ…æ•£å°±å¯ä»¥äº†</li><li>æ¥ç€æ”¾å‰©é¥­ï¼Œæ”¾ä¹‹å‰å¯ä»¥ç”¨æ‰‹ææ•£ï¼Œå¥½ç‚’äº›</li><li>æ”¾ç›ï¼Œæ”¾<strong>è€æŠ½</strong>ï¼Œç‚’ä¸€åˆ†é’Ÿå·¦å³</li><li>å†æ”¾è‘±èŠ±ï¼Œç‚’ä¸ªä¸¤åˆ°ä¸‰åˆ†é’Ÿï¼Œé¦™å‘³æ»¡æº¢å°±å¯ä»¥æ”¶é”…äº†</li></ul><p>è›‹ç‚’é¥­å¯æ‰©å±•æ€§éå¸¸å¼ºï¼Œå¯ä»¥åŠ é¦™è‚ ï¼Œèåœï¼Œé¦™è‡ï¼Œç‰ç±³ç­‰ä¸€èµ·ç‚’ã€‚ä½†æ˜¯ä¸€å®šè¦æ³¨æ„ï¼Œæ”¾å…¥è›‹ç‚’é¥­é‡Œçš„é£Ÿæå°½é‡éƒ½åˆ‡æˆé¢—ç²’çŠ¶ï¼Œå£æ„Ÿæ‰ç»Ÿä¸€ã€‚</p><h2 id="é¸¡èƒ¸è‚‰"><a href="#é¸¡èƒ¸è‚‰" class="headerlink" title="é¸¡èƒ¸è‚‰"></a>é¸¡èƒ¸è‚‰</h2><h3 id="è’¸-1"><a href="#è’¸-1" class="headerlink" title="è’¸"></a>è’¸</h3><p>1.ä¸€ä¸ªèƒ½è’¸ä¸œè¥¿çš„é”…+é¸¡èƒ¸è‚‰ï¼ˆåˆ‡æ¡ï¼‰<br>2.çº¢è–¯æ·€ç²‰/ç‰ç±³æ·€ç²‰ä¹Ÿå°±æ˜¯ç”Ÿç²‰ï¼Œè¶…å¸‚éƒ½æœ‰<br>3.èƒ¡æ¤’ç²‰<br>4.é…±æ²¹</p><p>è…Œåˆ¶ä¸€ä¼šå„¿ï¼Œç”Ÿç²‰èè¿›å»å°±å¥½</p><p>è’¸ 5 åˆ†é’Ÿå°±å·®ä¸å¤šäº†</p><h3 id="ç…®-1"><a href="#ç…®-1" class="headerlink" title="ç…®"></a>ç…®</h3><p>1.ä¸€ä¸ªç”µé¥­ç…²<br>2.é¸¡èƒ¸è‚‰é€‚é‡<br>3.è¥¿çº¢æŸ¿1ä¸ª<br>4.èƒ¡æ¤’ç²‰<br>5.æé”¦è®°çš„è’œè“‰é…±/ç”œè¾£é…±/ç”šè‡³è±†ç“£é…±éƒ½å¯ä»¥</p><p>åªéœ€è¦æ´—ä¸€æ´—é¸¡èƒ¸è‚‰ï¼Œç”¨èƒ¡æ¤’ç²‰æ¶‚ä¸Šå»è…Œå‡ åˆ†é’Ÿ</p><p>è¥¿çº¢æŸ¿åˆ‡æˆå°å—</p><p>ç„¶åå¼€å§‹ç…®<br>ä¸ç”¨åŠ æ°´<br>è¥¿çº¢æŸ¿æœ¬èº«ä¼šå‡ºæ±<br>5åˆ†é’Ÿå·¦å³å°±ç†Ÿäº†</p><p>ä¸è¦åœ<br>ç»§ç»­ç‚–<br>ç”¨å‹ºå­æ”¾å…¥é…± æƒ³æ”¾å¤šå°‘æ”¾å¤šå°‘ï¼Œä½†åˆ«å¤ªå¤šï¼Œè°ƒæ–™ä¹Ÿæ˜¯æœ‰çƒ­é‡çš„å“ˆï¼ï¼ï¼ï¼<br>å†è¿‡å‡ åˆ†é’Ÿ<br>å‡ºé”…</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšé¥­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå…¬å¼æ¸²æŸ“é—®é¢˜</title>
      <link href="/hexo-gong-shi-xuan-ran-wen-ti/"/>
      <url>/hexo-gong-shi-xuan-ran-wen-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸èƒ½æ¸²æŸ“çš„å…¬å¼"><a href="#ä¸èƒ½æ¸²æŸ“çš„å…¬å¼" class="headerlink" title="ä¸èƒ½æ¸²æŸ“çš„å…¬å¼"></a>ä¸èƒ½æ¸²æŸ“çš„å…¬å¼</h2><p>hexoä¸‹è‡ªå¸¦çš„markdownä¸èƒ½æ¸²æŸ“å¦‚ä¸‹å…¬å¼</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">\exist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è¡Œå†…å…¬å¼æ˜¾ç¤º"><a href="#è¡Œå†…å…¬å¼æ˜¾ç¤º" class="headerlink" title="è¡Œå†…å…¬å¼æ˜¾ç¤º"></a>è¡Œå†…å…¬å¼æ˜¾ç¤º</h2><p>å¦‚æœè¦æ”¯æŒè¡Œå†…å…¬å¼ï¼Œéœ€è¦å°†</p><p><code>node_modules\marked\lib\marked.ejs</code></p><p>ä¸­çš„</p><p><code>escape:</code> æ¢æˆ</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">escape<span class="token operator">:</span> /^\\(<span class="token punctuation">[</span>`*\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>()#$+\-.!_&gt;<span class="token punctuation">]</span>)/<span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>em:</code> æ¢æˆ</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">em<span class="token operator">:</span> /^\*((?<span class="token operator">:</span>\*\*|<span class="token punctuation">[</span>\s\S<span class="token punctuation">]</span>)+?)\*(?!\*)/<span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„è¿™æ ·å¤„ç†åï¼Œå¦‚æœå…¬å¼å‡ºç°ä¸¤ä¸ªè¿ç»­çš„{ï¼Œä¸­é—´è¦åŠ ç©ºæ ¼</p><h2 id="å…¬å¼æ¢è¡Œé—®é¢˜"><a href="#å…¬å¼æ¢è¡Œé—®é¢˜" class="headerlink" title="å…¬å¼æ¢è¡Œé—®é¢˜"></a>å…¬å¼æ¢è¡Œé—®é¢˜</h2><p>å¦‚æœåœ¨å…¬å¼å—ä¸­æ‰“ <code>\\</code> æ¥æ¢è¡Œï¼Œå¦‚æœæ˜¯çº¯markdownå°±æ²¡é—®é¢˜ï¼Œä½†æ˜¯hexoä¼šå¸¦å…¥å‰ç«¯æ¸²æŸ“ï¼Œè¿™ä¸ªä¼šè¢«è§£ææˆä¸€ä¸ª <code>\</code>ï¼Œæ‰€ä»¥éœ€è¦æ‰“å››ä¸ª <code>\\\\</code>ï¼Œå°±å¯ä»¥æˆåŠŸæ¢è¡Œäº†</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢é—®é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022CCPCæ±Ÿè‹çœèµ›</title>
      <link href="/2022ccpc-jiang-su-sheng-sai/"/>
      <url>/2022ccpc-jiang-su-sheng-sai/</url>
      
        <content type="html"><![CDATA[<p>åªè®°å½•å†™äº†çš„é¢˜</p><h2 id="A-PENTA-KILL"><a href="#A-PENTA-KILL" class="headerlink" title="A  PENTA KILL!"></a>A  <a href="https://codeforces.com/gym/103743/problem/A">PENTA KILL!</a></h2><p>ç­¾åˆ°é¢˜ï¼Œä¸»è¦éš¾ç‚¹åœ¨äºè¯»é¢˜â€¦</p><p>å¦‚æœä½ ç©mobaç±»æ¸¸æˆï¼Œä¼šè§‰å¾—ä»–è¿™ä¸ªé¢˜æ„ååˆ†åˆ«æ‰­ï¼Œå¬è¯´æœ‰ä¸ªçœèµ›é‡‘ç‰Œçˆ·è¿™é¢˜å¼€å±€é”™äº†äº”å‘</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> n<span class="token punctuation">;</span>cin <span class="token operator">&gt;&gt;</span> n<span class="token punctuation">;</span>unordered_map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;&gt;</span> m<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>string u<span class="token punctuation">,</span> v<span class="token punctuation">;</span>cin <span class="token operator">&gt;&gt;</span> u <span class="token operator">&gt;&gt;</span> v<span class="token punctuation">;</span>m<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>_<span class="token punctuation">,</span> s<span class="token punctuation">]</span> <span class="token operator">:</span> m<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">bool</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"PENTA KILL!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"SAD:("</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="C-Jump-and-Treasure"><a href="#C-Jump-and-Treasure" class="headerlink" title="C Jump and Treasure"></a>C <a href="https://codeforces.com/gym/103743/problem/C">Jump and Treasure</a></h2><h3 id="å¤§æ„"><a href="#å¤§æ„" class="headerlink" title="å¤§æ„"></a>å¤§æ„</h3><p>æœ‰ä¸ªè°ƒçš®çš„å°æœ‹å‹åœ¨æ•°è½´çš„æŸ±å­ä¸Šå¾€æ­£æ–¹å‘è·³ï¼Œä¸€å¼€å§‹åœ¨ $ 0 $ ï¼Œæœ‰ $n(1 \le n \le 10^6)$ ä¸ªæŸ±å­å¯ä»¥è·³ï¼Œåˆ†åˆ«ä½äº $1,2,3,\dots,n$ ï¼Œè·³çš„è·ç¦»ä¸èƒ½è¶…è¿‡ $p(2 \le p \le 10^6)$ï¼Œæ¯ä¸ªæŸ±å­çš„æƒå€¼ä¸º $a_{i} (-10^9 \le a_{i} \le 10^9)$ã€‚æœ‰ $q(1 \le q \le 10^6)$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å®šä¸€ä¸ªæ•° $x$ ï¼Œé™å®šè·³çš„è·ç¦»åªèƒ½æ˜¯ $x(1 \le x \le n)$ çš„å€æ•°ï¼Œè·³åˆ°  $[n+1,+\infty)$ å³è§†ä¸ºæ¸¸æˆèƒœåˆ©ã€‚å¯¹æ¯æ¬¡è¯¢é—®ï¼Œå¦‚æœèƒ½èƒœåˆ©ï¼Œæ±‚è·³çš„æŸ±å­æƒå€¼å’Œæœ€å¤§å€¼ï¼Œå¦åˆ™è¾“å‡º $Noob$ ã€‚</p><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>æ˜“çŸ¥ä¸ç”¨ç®¡å¤§äºpçš„è·³è·ƒè·ç¦»ã€‚å¦‚æœå¯¹å‰©ä¸‹çš„æ¯ç§è·³è·ƒè·ç¦»æšä¸¾ï¼Œæ‰¾åˆ°æ¯ç§è·ç¦»èƒ½è·³çš„æ‰€æœ‰æŸ±å­ï¼Œç¬¦åˆè°ƒå’Œçº§æ•°å¤æ‚åº¦ï¼Œä¸º $O(nlogn)$ã€‚å¯¹æ¯ä¸ªè·ç¦»æ‰¾åˆ°çš„æŸ±å­è¿›è¡ŒåŠ¨æ€è§„åˆ’ï¼Œæ˜“åˆ—å‡ºè½¬ç§»å¼<br>$$<br>dp[i] =  max_{iâˆ’j \le p}(dp[j]) + a[i]<br>$$<br>ç„¶åè¿™å°±æ˜¯å•è°ƒé˜Ÿåˆ—çš„ç»å…¸è¿ç”¨äº†ï¼Œæ³¨æ„ç©ºé—´ä¼˜åŒ–ï¼Œæ¯•ç«Ÿæ˜¯ç”¨ $long \; long$ å­˜çš„ï¼Œè¾“å…¥è¾“å‡ºä¹Ÿæ³¨æ„ä¼˜åŒ–ï¼Œå› ä¸ºå·²ç»åˆ°äº†ç™¾ä¸‡çº§äº†ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">using</span> ll <span class="token operator">=</span> <span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token keyword">int</span> a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>ll ans<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">;</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>q<span class="token punctuation">,</span> <span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> a <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fill</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> ans <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> LLONG_MIN<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> p<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>deque<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> q<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>ll<span class="token operator">&gt;</span> <span class="token function">dp</span><span class="token punctuation">(</span>n <span class="token operator">/</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> LLONG_MIN<span class="token punctuation">)</span><span class="token punctuation">;</span>dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">,</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">+=</span> i<span class="token punctuation">,</span> <span class="token operator">++</span>cnt<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cnt <span class="token operator">-</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> i <span class="token operator">&gt;</span> p<span class="token punctuation">)</span>q<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>dp<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> p <span class="token operator">&gt;</span> n<span class="token punctuation">)</span>ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> dp<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> dp<span class="token punctuation">[</span>q<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>q<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> q<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> p<span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Noob\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="I-Cutting-Suffix"><a href="#I-Cutting-Suffix" class="headerlink" title="I Cutting Suffix"></a>I <a href="https://codeforces.com/gym/103743/problem/I">Cutting Suffix</a></h2><h3 id="å¤§æ„-1"><a href="#å¤§æ„-1" class="headerlink" title="å¤§æ„"></a>å¤§æ„</h3><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°†å…¶æ‰€æœ‰åç¼€å­—ç¬¦ä¸²åˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼Œä½¿å¾—é›†åˆä¸€çš„æ¯ä¸ªå­—ç¬¦ä¸²ä¸é›†åˆäºŒçš„æ¯ä¸ªå­—ç¬¦ä¸²ä¸¤ä¸¤ä¹‹é—´æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦ä¹‹å’Œæœ€å°</p><h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å¦‚æœè¯¥å­—ç¬¦ä¸²ä¸æ˜¯åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆæ€»å¯ä»¥æŒ‰åç¼€å­—ç¬¦ä¸²çš„é¦–å­—æ¯æ‹†æˆä¸¤ä¸ªé›†åˆï¼Œä¸¤ä¸ªé›†åˆé‡Œçš„å­—ç¬¦ä¸²ä¸¤ä¸¤å…¬å…±å‰ç¼€é•¿åº¦å‡ä¸º $0$ ï¼Œæ€»å’Œä¸º $0$ ã€‚å¦‚æœè¯¥å­—ç¬¦ä¸²åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°†é•¿åº¦ä¸º $1$ çš„åç¼€å­—ç¬¦ä¸²å•ç‹¬åˆ’ä¸ºä¸€ä¸ªé›†åˆï¼Œå…¶ä»–åœ¨å¦ä¸€ä¸ªé›†åˆï¼Œæ€»å’Œå³ä¸ºåŸå­—ç¬¦ä¸²é•¿åº¦å‡ $1$</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span>cin <span class="token operator">&gt;&gt;</span> s<span class="token punctuation">;</span>unordered_set<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">else</span>cout <span class="token operator">&lt;&lt;</span> <span class="token number">0</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="J-Balanced-Tree"><a href="#J-Balanced-Tree" class="headerlink" title="J Balanced Tree"></a>J <a href="https://codeforces.com/gym/103743/problem/J">Balanced Tree</a></h2><h3 id="å¤§æ„-2"><a href="#å¤§æ„-2" class="headerlink" title="å¤§æ„"></a>å¤§æ„</h3><p>$T(1 \le T \le 10^6)$ ç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„ç»™ä¸€ä¸ªæ•° $n(0 \le n \lt 2^{64})$ ï¼Œæ±‚èŠ‚ç‚¹æ•°ä¸º $n$ çš„è¶…çº§å¹³è¡¡äºŒå‰æ ‘æ•°é‡ï¼Œç­”æ¡ˆæ¨¡$2^{64}$ ã€‚å¦‚æœä¸€æ£µæ ‘ä¸ºç©ºæ ‘ï¼Œæˆ–è€…å·¦å­æ ‘èŠ‚ç‚¹æ•°å’Œå³å­æ ‘èŠ‚ç‚¹æ•°ä¹‹å·®å°äºç­‰äº $1$ ï¼Œåˆ™ä¸ºè¶…çº§å¹³è¡¡äºŒå‰æ ‘ã€‚å¯¹æ­¤é¢˜ç‰¹åˆ«æä¸€ä¸‹ç©ºé—´åªç»™äº† $64MB$ ï¼Œæ—¶é™æ˜¯ $1.5s$ ã€‚</p><h3 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸‹é¢çš„é€’å½’å¼ã€‚<br>$$<br>f[0]=1 \\\<br>f[x]=<br>\begin{cases}<br>2f[\frac{x}{2}]f[\frac{x}{2}-1],\quad x ä¸ºå¶æ•° \\\<br>f[\frac{x-1}{2}]^2,\quad xä¸ºå¥‡æ•°<br>\end{cases}<br>$$<br>åŠ ä¸Šå“ˆå¸Œå°±æˆäº†è®°å¿†åŒ–æœç´¢ï¼Œä½¿ç”¨C++çš„unsigned long longè‡ªç„¶æº¢å‡ºå–æ¨¡ï¼Œä»£ç å¦‚ä¸‹</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">using</span> R <span class="token operator">=</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>R n<span class="token punctuation">;</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%llu"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>unordered_map<span class="token operator">&lt;</span>R<span class="token punctuation">,</span> R<span class="token operator">&gt;</span> m<span class="token punctuation">;</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>function<span class="token operator">&lt;</span><span class="token function">R</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token operator">&gt;</span> dfs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>R x<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span> m<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>R les <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>m<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>les<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">dfs</span><span class="token punctuation">(</span>les <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">else</span>m<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>les<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">dfs</span><span class="token punctuation">(</span>les<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> m<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%llu\n"</span><span class="token punctuation">,</span> <span class="token function">dfs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">int</span> t<span class="token punctuation">;</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>t<span class="token operator">--</span><span class="token punctuation">)</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‡’å¾—ç®—å¤æ‚åº¦äº†ï¼Œç›´æ¥äº¤ï¼Œæœç„¶è¶…æ—¶ã€‚å¦‚æœæŠŠå®¹å™¨å’Œå‡½æ•°ç§»åˆ°solveå¤–é¢ï¼Œé‚£ä¹ˆå°±è¶…ç©ºé—´ã€‚</p><p>è€ƒè™‘ä¼˜åŒ–ï¼Œç”±é€’å½’å¼å¯ä»¥çœ‹å‡ºç»“æœä¸º2çš„å¹‚ï¼Œè¦æ˜¯èƒ½ç›´æ¥å¾—åˆ°å¹‚å°±å¥½è§£äº†ï¼Œå¹‚å¤§äºç­‰äº64çš„ç»“æœä¸º0ï¼Œå…¶ä»–çš„è¾“å‡ºç»“æœå³å¯</p><p>ä¸ºäº†å¾—åˆ°å¹‚ï¼Œè¿›è¡Œå–å¯¹æ•°æ“ä½œ<br>$$<br>è®¾\; g[x]=\log_{2}{f[x]}ï¼Œæœ‰\\\<br>g[0]=0\\\<br>g[x]=<br>\begin{cases}<br>g[\frac{x}{2}]+g[\frac{x}{2}-1]+1,\quad x ä¸ºå¶æ•°\\\<br>2g[\frac{x-1}{2}],\quad xä¸ºå¥‡æ•°<br>\end{cases}\\\<br>ç”±ä¸Šæ˜“çŸ¥\;\forall n \in N,å­˜åœ¨\; x \in N^{*},\;g[n]=a \cdot g[x]+b \cdot g[x-1]+c\\\<br>åŒ–ä¸º\;g[n]=<br>\begin{cases}<br>a \cdot (g[\frac{x}{2}] + g[\frac{x}{2} âˆ’ 1] + 1) + b \cdot (2g[\frac{x-1-1}{2}]) + c,\quad xæ˜¯å¶æ•°\\\<br>a \cdot (2g[\frac{x-1}{2}]) + b \cdot (g[\frac{x-1}{2}] + g[\frac{x-1}{2} âˆ’ 1] + 1) + c,\quad xæ˜¯å¥‡æ•°<br>\end{cases}\\\<br>=<br>\begin{cases}<br>a \cdot g[\frac{x}{2}] + (a+2b) \cdot g[\frac{x}{2}-1] + c + a,\quad xæ˜¯å¶æ•°\\\<br>(2a+b) \cdot g[\frac{x-1}{2}] + b \cdot g[\frac{x-1}{2}-1] + c + b,\quad xæ˜¯å¥‡æ•°<br>\end{cases}\\\<br>äºæ˜¯åˆå§‹\;g[n]=1\cdot g[n] + 0 \cdot g[n-1] + 0\\\<br>ä¸æ–­é™¤äºŒç›´åˆ°\;n = 1,åŒ–ä¸º\\\<br>g[n] = a\cdot g[1] + b \cdot g[0] + c=c<br>$$<br>æœ€ååªéœ€è¦å¯¹ $c$  è¿›è¡Œå‰æ–‡æåˆ°çš„åˆ¤æ–­å³å¯å¾—åˆ°ç­”æ¡ˆ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">using</span> R <span class="token operator">=</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>R n<span class="token punctuation">;</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%llu"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>R a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>a <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">,</span> a <span class="token operator">+=</span> b<span class="token punctuation">,</span> c <span class="token operator">+=</span> b<span class="token punctuation">;</span><span class="token keyword">else</span>b <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">+=</span> a<span class="token punctuation">,</span> c <span class="token operator">+=</span> a<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">&gt;=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>n <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%llu\n"</span><span class="token punctuation">,</span> <span class="token number">1ull</span> <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">int</span> t<span class="token punctuation">;</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>t<span class="token operator">--</span><span class="token punctuation">)</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œè®°å½•ä¸€ä¸ªå‘ç‚¹ï¼ŒC++ç¼–è¯‘å™¨ç§ç±»å®åœ¨å¤ªå¤šäº†ã€‚ã€‚ã€‚ä½ ä»»ä½•ä¸è§„èŒƒçš„æ“ä½œéƒ½æœ‰å¯èƒ½å¯¼è‡´åœ¨ä¸åŒç¼–è¯‘å™¨ä¸‹ç»“æœä¸åŒï¼Œåœ¨æ­¤é¢˜ä¸­ï¼Œä¹‹å‰çŠ¯çš„é”™è¯¯æ˜¯å¿½ç•¥äº†ç¼–è¯‘å™¨çš„è­¦å‘Šï¼Œè¿™æ ·è¿›è¡Œè¾“å‡º <code>printf("%llu\n", 0);</code> ï¼Œåœ¨æœ‰äº›ç¼–è¯‘å™¨ä¸‹ä¸ä¸€å®šè¾“å‡º0ï¼Œè€Œæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°ï¼Œé™¤éåœ¨æ ¼å¼åŒ–è¾“å‡ºå‰å¯¹ $0$ è¿›è¡Œå¼ºè½¬ï¼Œè½¬ä¸ºunsigned long long</p><h2 id="K-aaaaaaaaaaA-heH-heH-nuN"><a href="#K-aaaaaaaaaaA-heH-heH-nuN" class="headerlink" title="K aaaaaaaaaaA heH heH nuN"></a>K <a href="https://codeforces.com/gym/103743/problem/K">aaaaaaaaaaA heH heH nuN</a></h2><h3 id="å¤§æ„-3"><a href="#å¤§æ„-3" class="headerlink" title="å¤§æ„"></a>å¤§æ„</h3><p>$T(1\le T \le 1000)$ ç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„ç»™å‡ºä¸€ä¸ªæ•° $n (0 \le n \le 10^9)$ ï¼Œæ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶æ‰€æœ‰å­åºåˆ—ä¸­ï¼Œä¼˜é›…å­—ç¬¦ä¸²çš„æ•°é‡ä¸º $n$ã€‚ä¼˜é›…å­—ç¬¦ä¸²çš„å®šä¹‰æ˜¯ï¼Œå‰ç¼€ä¸º $ nunhehheh $ ï¼Œåç¼€ä¸ºä»»æ„éé›¶æ•°é‡çš„ $a$ ã€‚ä¸”ä½ è¾“å‡ºçš„æ‰€æœ‰å­—ç¬¦ä¸²é•¿åº¦æ€»å’Œä¸è¶…è¿‡ $10^6$</p><h3 id="æ€è·¯-3"><a href="#æ€è·¯-3" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è¯¥é¢˜æœ‰ç‚¹ååŠ¨æ€è§„åˆ’çš„æ„Ÿè§‰ï¼Œé€šè¿‡ç­”æ¡ˆæ¥æ„é€ ã€‚ä¸€èˆ¬è¿™ç§æ•°æ®èŒƒå›´è¿™ä¹ˆå¤§çš„ï¼Œéƒ½æ˜¯æœ‰æŒ‡æ•°çº§æ„é€ æ³•çš„ã€‚å¾ˆå®¹æ˜“æƒ³åˆ°å¦‚æœåœ¨  $ nunhehhe $ åé¢ï¼ŒåŠ ä¸Š $n$ ä¸ª $h$ ï¼Œæœ€ååŠ ä¸Šä¸ª $a$ ï¼Œæ€»èƒ½æ„é€ å‡ºæ‰€æœ‰çš„å€¼ã€‚ä½†ç”±äºè¾“å‡ºé•¿åº¦é™åˆ¶ä¸èƒ½è¿™ä¹ˆåšã€‚</p><p>è¦æŒ‡æ•°çº§åªèƒ½ä» $a$ çš„ä¸ªæ•°ä¸‹æ‰‹ï¼Œå®¹æ˜“å‘ç° $nunhehheh\underbrace{a\dots a}_{xä¸ª}$ è¿™ç§å½¢å¼ç¬¦åˆè¦æ±‚çš„å­åºåˆ—æœ‰ $2^x-1$ ä¸ªï¼Œäºæ˜¯å°±å¯ä»¥ä»å¤§åˆ°å°æšä¸¾ $x$ ï¼Œ$n$ å¤§äºç­‰äº $2^x -1$ å°±å‡å»ï¼Œæ·»åŠ  $h$ </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">int</span> n<span class="token punctuation">;</span>cin <span class="token operator">&gt;&gt;</span> n<span class="token punctuation">;</span>string ans <span class="token operator">=</span> <span class="token string">"nunhehhe"</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>ans <span class="token operator">+=</span> <span class="token char">'a'</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ans <span class="token operator">+=</span> <span class="token char">'h'</span><span class="token punctuation">;</span>n <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>ans <span class="token operator">+=</span> <span class="token char">'a'</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> ans <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> t<span class="token punctuation">;</span>cin <span class="token operator">&gt;&gt;</span> t<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>t<span class="token operator">--</span><span class="token punctuation">)</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="L-Collecting-Diamonds"><a href="#L-Collecting-Diamonds" class="headerlink" title="L Collecting Diamonds"></a>L <a href="https://codeforces.com/gym/103743/problem/L">Collecting Diamonds</a></h2><h3 id="å¤§æ„-4"><a href="#å¤§æ„-4" class="headerlink" title="å¤§æ„"></a>å¤§æ„</h3><p>ç»™ä½ ä¸€ä¸ªç”±å­—ç¬¦ $A,B,C$  æ„æˆçš„å­—ç¬¦ä¸²ï¼Œé•¿åº¦å°äº $2 \cdot 10^5$ï¼Œæ¯ä¸ªå­—ç¬¦çš„ä¸‹æ ‡ä¸º $1,2,3,\dots,n$ ã€‚å¦‚æœå­ä¸²æœ‰ $ABC$  ï¼Œåˆ™å¯ä»¥è¿›è¡Œæ“ä½œï¼Œ$A$ ä¸ºå¥‡æ•°ä¸‹æ ‡åˆ™å–èµ°è¯¥å­ä¸²çš„$A,C$ï¼Œä¸ºå¶æ•°ä¸‹æ ‡åˆ™å–èµ° $B$ ï¼Œè¯¥å­—ç¬¦ä¸²å‰©ä¸‹çš„å­—ç¬¦é¡ºæ¬¡æ‹¼æ¥ï¼Œå¹¶é‡æ–°åˆ’å®šä¸‹æ ‡ã€‚é—®æœ€å¤šèƒ½å¤Ÿè¿›è¡Œå¤šå°‘æ¬¡æ“ä½œã€‚</p><h3 id="æ€è·¯-4"><a href="#æ€è·¯-4" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>é¦–å…ˆæ˜“è§ï¼Œä¸¤ç§æ“ä½œä¸­ï¼Œåªæœ‰å–èµ° $A,C$ æ‰å¯ä»¥è¿ç»­æ“ä½œï¼ŒåŒæ—¶è¯¥æ“ä½œä¸ä¼šæ”¹å˜åé¢ä¸‹æ ‡çš„å¥‡å¶æ€§ã€‚åªæœ‰å–èµ° $B$ï¼Œæ‰ä¼šæ”¹å˜ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ¯ä¸ªç±»ä¼¼ $AAA\dots ABC \dots CCC$ çš„å­ä¸²éƒ½ç›¸å¯¹ç‹¬ç«‹ï¼Œå³å¯¹è¯¥å­ä¸²è¿›è¡Œæ“ä½œï¼Œä¸ä¼šå½±å“å…¶ä»–è¿™ç±»å­ä¸²çš„å­—ç¬¦æ•°é‡ï¼Œäºæ˜¯æ¯æ¬¡æ‰¾åˆ° $B$ å¯ä»¥å·¦å³æ‰¾ $A,C$ï¼Œå°†åŸå­—ç¬¦ä¸²åˆ’åˆ†ã€‚</p><p>è¿˜æœ‰ï¼Œå–èµ° $B$ å¯¹ä¸Šè¿°åˆ’åˆ†åçš„å­ä¸²ï¼Œæœ€å¤šåªèƒ½è¿›è¡Œä¸€æ¬¡ã€‚æˆ‘ä»¬ä¸ºäº†èƒ½å¯¹åé¢è¿›è¡Œæ›´çµæ´»çš„æ“ä½œï¼Œè‚¯å®šæ˜¯å°½å¯èƒ½è®©å‰é¢çš„å­ä¸²éƒ½è¿›è¡Œä¸€æ¬¡å– $B$ çš„æ“ä½œ</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå˜é‡æš‚å­˜å‰é¢å– $B$ æ“ä½œçš„æ¬¡æ•°ï¼Œè®¡ç®—æ¯ä¸ªå­ä¸²æœ€å¤šèƒ½åˆ é™¤å¤šå°‘æ¬¡ $A,C$ </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span>cin <span class="token operator">&gt;&gt;</span> s<span class="token punctuation">;</span><span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'B'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">int</span> l <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">and</span> r <span class="token operator">&lt;</span> n <span class="token operator">and</span> s<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'A'</span> <span class="token operator">and</span> s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'C'</span><span class="token punctuation">)</span><span class="token operator">--</span>l<span class="token punctuation">,</span> <span class="token operator">++</span>r<span class="token punctuation">,</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span><span class="token operator">++</span>l<span class="token punctuation">,</span> <span class="token operator">--</span>r<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>tot<span class="token punctuation">)</span><span class="token operator">++</span>tot<span class="token punctuation">;</span>ans <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>ans <span class="token operator">+=</span> <span class="token function">min</span><span class="token punctuation">(</span>tot<span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token operator">++</span>tot<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>ans <span class="token operator">+=</span> <span class="token function">min</span><span class="token punctuation">(</span>tot<span class="token punctuation">,</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">++</span>tot<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>cout <span class="token operator">&lt;&lt;</span> ans <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¨‹åºè®¾è®¡ç«èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CCPC </tag>
            
            <tag> ç®—æ³•é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/test/"/>
      <url>/test/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¬å¼æµ‹è¯•"><a href="#å…¬å¼æµ‹è¯•" class="headerlink" title="å…¬å¼æµ‹è¯•"></a>å…¬å¼æµ‹è¯•</h1><p>$O(n^2)$<br>$$<br>ans = \sum_{1}^n \sqrt{\frac{4ac-b^2}{2a}}<br>$$</p><h1 id="ä»£ç æµ‹è¯•"><a href="#ä»£ç æµ‹è¯•" class="headerlink" title="ä»£ç æµ‹è¯•"></a>ä»£ç æµ‹è¯•</h1><p>æ³¨ï¼šåœ¨hexoæ¡†æ¶ä¸‹ï¼Œmarkdownæ ‡ç¤ºc++è¯­è¨€éœ€è¦å†™æˆcpp</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>    cin <span class="token operator">&gt;&gt;</span> a <span class="token operator">&gt;&gt;</span> b<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">+</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="è¡¨æƒ…æµ‹è¯•"><a href="#è¡¨æƒ…æµ‹è¯•" class="headerlink" title="è¡¨æƒ…æµ‹è¯•"></a>è¡¨æƒ…æµ‹è¯•</h1><p>ğŸ˜†</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢é—®é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
